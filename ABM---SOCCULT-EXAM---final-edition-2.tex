\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={ABM---SOCCULT-EXAM---final-edition-2.R},
            pdfauthor={bella},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{ABM---SOCCULT-EXAM---final-edition-2.R}
\author{bella}
\date{2020-05-17}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# SOCIAL AND CULTURAL DYNAMICS IN COGNITION EXAM SPRING 2020 #}
\CommentTok{# Diagnostic disparity in women with Asperger's Syndrome #}
\CommentTok{# Bella Terragni #}


\NormalTok{############## SECTION 0 - set-up ############}

\CommentTok{# load packages}
\NormalTok{pacman}\OperatorTok{::}\KeywordTok{p_load}\NormalTok{(dplyr, tidyr, MASS, tidyverse, psych, viridis, wesanderson)}

\CommentTok{# set theme for visualizations}
\KeywordTok{theme_set}\NormalTok{(}\KeywordTok{theme_minimal}\NormalTok{())}



\NormalTok{############## SECTION 1 - functions for simulation ############}

\CommentTok{# In this section, I define the general functions utilized when running the simulation}

\CommentTok{# Function that assigns individuals with ASD if they have n symptoms or more above a set value (severity_level)}
\CommentTok{# takes four parameters: the dataset with agents and their assigned symptom severities, number of possible symptoms,}
\CommentTok{# a value for the severity level needed for a symptom to be clinically present, and a cut-off value for number of}
\CommentTok{# symptoms needed before an individual clinically speaking has ASD.}
\CommentTok{# I set default values, since I use the same values throughout the simulation, but want to retain the flexibility}
\CommentTok{# to run simulations with other values}
\CommentTok{# NB: this is the function that determines the "true" dagnosis of the individuals that the diagnostic_model() function later tries to guess}
\NormalTok{assign_ASD <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(D_all, }\DataTypeTok{n_symptoms =} \DecValTok{9}\NormalTok{, }\DataTypeTok{severity_level =} \FloatTok{0.4}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{6}\NormalTok{)\{}
\NormalTok{  D_all}\OperatorTok{$}\NormalTok{symptoms <-}\StringTok{ "N/A"}
\NormalTok{  D_all}\OperatorTok{$}\NormalTok{ASD <-}\StringTok{ "N/A"}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_all)))\{}
\NormalTok{    symp_count <-}\StringTok{ }\DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{n_symptoms)\{}
      \ControlFlowTok{if}\NormalTok{ (D_all[[i, }\DecValTok{2}\OperatorTok{+}\NormalTok{j]] }\OperatorTok{>}\StringTok{ }\NormalTok{severity_level)\{}
\NormalTok{        symp_count =}\StringTok{ }\NormalTok{symp_count }\OperatorTok{+}\StringTok{ }\DecValTok{1}
\NormalTok{      \}\}}
\NormalTok{    D_all[i,}\StringTok{"symptoms"}\NormalTok{] <-}\StringTok{ }\NormalTok{symp_count}
    \ControlFlowTok{if}\NormalTok{ (D_all}\OperatorTok{$}\NormalTok{symptoms[[i]] }\OperatorTok{>=}\StringTok{ }\NormalTok{n_symptom_cutoff)\{}
\NormalTok{      D_all[i,}\StringTok{"ASD"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      D_all[i,}\StringTok{"ASD"}\NormalTok{] <-}\StringTok{ }\DecValTok{0}
\NormalTok{    \}}
\NormalTok{  \}}
  \CommentTok{# converting factors to numerics}
\NormalTok{  D_all}\OperatorTok{$}\NormalTok{symptoms <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(D_all}\OperatorTok{$}\NormalTok{symptoms))}
\NormalTok{  D_all}\OperatorTok{$}\NormalTok{ASD <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(D_all}\OperatorTok{$}\NormalTok{ASD))}
  \KeywordTok{return}\NormalTok{(D_all)}
\NormalTok{\}}


\CommentTok{# function that determines which symptoms are the most prominent (based on mean) in a specific population}
\CommentTok{# the function takes 5 parameters: full dataset, sample size of group for diagnostic updating, number of diagnostic criteria,}
\CommentTok{# percentage of males in diagnostic updating sample (decimals), and a subset criterium. If no subset is needed, use default.}
\CommentTok{# function returns vector of n symptoms used for diagnostic criteria}
\NormalTok{diagnostic_criteria_model <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(full_dataset, sample_size, n_diagnostic_criteria, male_percent, }\DataTypeTok{subset_criterium1 =}\NormalTok{ T) \{}
  \CommentTok{# subset specific group with ASD diagnosis}
\NormalTok{  diagnostic_group_m <-}\StringTok{ }\NormalTok{full_dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(subset_criterium1) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{)}
\NormalTok{  diagnostic_group_f <-}\StringTok{ }\NormalTok{full_dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(subset_criterium1) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{)}
  \CommentTok{# sample randomly from groups}
  \CommentTok{# diagnostic_sample <- diagnostic_group_m[sample(nrow(diagnostic_group_m), sample_size), ]}
\NormalTok{  diagnostic_sample_m <-}\StringTok{ }\NormalTok{diagnostic_group_m[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(diagnostic_group_m), sample_size}\OperatorTok{*}\NormalTok{male_percent), ]}
\NormalTok{  diagnostic_sample_f <-}\StringTok{ }\NormalTok{diagnostic_group_f[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(diagnostic_group_f), sample_size}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{male_percent)), ]}
\NormalTok{  diagnostic_sample <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(diagnostic_sample_m, diagnostic_sample_f)}
  \CommentTok{# calculate mean symptom severity}
\NormalTok{  symptom_severity <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{S1 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S1), }\DataTypeTok{S2 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S2), }\DataTypeTok{S3 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S3), }\DataTypeTok{S4 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S4), }\DataTypeTok{S5 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S5), }\DataTypeTok{S6 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S6), }\DataTypeTok{S7 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S7), }\DataTypeTok{S8 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S8), }\DataTypeTok{S9 =} \KeywordTok{mean}\NormalTok{(diagnostic_sample}\OperatorTok{$}\NormalTok{S9))}
  \CommentTok{# sort symptoms}
\NormalTok{  symptom_severity <-}\StringTok{ }\KeywordTok{gather}\NormalTok{(symptom_severity)}
\NormalTok{  symptom_severity <-}\StringTok{ }\NormalTok{symptom_severity[}\KeywordTok{order}\NormalTok{(}\OperatorTok{-}\NormalTok{symptom_severity}\OperatorTok{$}\NormalTok{value), ]}
  \CommentTok{# subset the highest ranking symptoms (uses parameter value)}
\NormalTok{  diagnostic_criteria <-}\StringTok{ }\NormalTok{symptom_severity[}\DecValTok{1}\OperatorTok{:}\NormalTok{n_diagnostic_criteria, ]}
  \CommentTok{# make vector with diagnostic criteria symptoms}
\NormalTok{  diagnostic_criteria <-}\StringTok{ }\KeywordTok{c}\NormalTok{(diagnostic_criteria[,}\DecValTok{1}\NormalTok{])}
  \KeywordTok{return}\NormalTok{(diagnostic_criteria)}
\NormalTok{\}}


\CommentTok{# function that diagnoses people with ASD if they have n_symptom_cutoff or more of the diagnostic criteria}
\CommentTok{# takes full_dataset, diagnostic_criteria vector from diagnostic_criteria_model() and a set number for n_symptom_cutoff }
\NormalTok{diagnostic_model <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(full_dataset, diagnostic_criteria, n_symptom_cutoff)\{}
\NormalTok{  round <-}\StringTok{ }\NormalTok{((}\KeywordTok{ncol}\NormalTok{(full_dataset)) }\OperatorTok{-}\StringTok{ }\DecValTok{12}\NormalTok{)}
\NormalTok{  round <-}\StringTok{ }\KeywordTok{as.character}\NormalTok{(round)}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(full_dataset))\{}
\NormalTok{    diagnostic_symp_count <-}\StringTok{ }\DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(diagnostic_criteria))\{}
\NormalTok{      symptom <-}\StringTok{ }\NormalTok{diagnostic_criteria[j]}
      \ControlFlowTok{if}\NormalTok{ (full_dataset[i,symptom] }\OperatorTok{>}\StringTok{ }\FloatTok{0.5}\NormalTok{)\{}
\NormalTok{        diagnostic_symp_count =}\StringTok{ }\NormalTok{diagnostic_symp_count }\OperatorTok{+}\StringTok{ }\DecValTok{1}
\NormalTok{      \}\}}
    \ControlFlowTok{if}\NormalTok{ (diagnostic_symp_count }\OperatorTok{>=}\StringTok{ }\NormalTok{n_symptom_cutoff)\{}
\NormalTok{      full_dataset[i,round] <-}\StringTok{ }\DecValTok{1}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      full_dataset[i,round] <-}\StringTok{ }\DecValTok{0}
\NormalTok{    \} \}}
  \KeywordTok{names}\NormalTok{(full_dataset)[}\KeywordTok{names}\NormalTok{(full_dataset) }\OperatorTok{==}\StringTok{ }\NormalTok{round] <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"ASD"}\NormalTok{, round, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{)}
  \KeywordTok{return}\NormalTok{(full_dataset)}
\NormalTok{\}}


\CommentTok{# function that calculates the amount of false negatives and positives, as well as true negatives and postitives in set}
\CommentTok{# takes the full dataset from diagnostic_model() as a parameter}
\NormalTok{evaluate_diagnosis <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(full_dataset) \{}
\NormalTok{  full_dataset <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(full_dataset, }\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{  evaluation_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(full_dataset)}\OperatorTok{-}\DecValTok{13}\NormalTok{)))\{}
\NormalTok{    round <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"ASD"}\NormalTok{, j, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{)}
\NormalTok{    eval <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"Eval"}\NormalTok{, j, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{)}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(full_dataset))\{}
      \ControlFlowTok{if}\NormalTok{ (full_dataset[i,}\StringTok{"ASD"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\DecValTok{1} \OperatorTok{&}\StringTok{ }\NormalTok{full_dataset[i,round] }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
\NormalTok{        evaluation_data[i, j] <-}\StringTok{ "TP"}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (full_dataset[i, }\StringTok{"ASD"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\DecValTok{1} \OperatorTok{&}\StringTok{ }\NormalTok{full_dataset[i,round] }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
\NormalTok{        evaluation_data[i, j] <-}\StringTok{ "FN"}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (full_dataset[i, }\StringTok{"ASD"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{full_dataset[i, round] }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
\NormalTok{        evaluation_data[i, j] <-}\StringTok{ "TN"}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (full_dataset[i,}\StringTok{"ASD"}\NormalTok{] }\OperatorTok{==}\StringTok{ }\DecValTok{0} \OperatorTok{&}\StringTok{ }\NormalTok{full_dataset[i, round] }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
\NormalTok{        evaluation_data[i, j] <-}\StringTok{ "FP"}
\NormalTok{      \}\}}
\NormalTok{  \}}
  \KeywordTok{return}\NormalTok{(evaluation_data)}
\NormalTok{\}}


\CommentTok{# Function that combines and runs the 3 functions above (diagnostic_criteria_model(), diagnostic_model(), and evaluate_diagnosis()) for n iterations}
\CommentTok{# Takes the parameters: full dataset, number of iterations, size diagnostic updating sample, number of diagnostic symptoms, number of symptoms}
\CommentTok{# needed to get diagnsed (n_symptom_cutoff), as well as the percentage of males in the diagnostic analysis group (decimal).}
\CommentTok{# Function returns list of data frames. The first data frame contains the raw simulation data, the second contains the diagnostic vectors used for}
\CommentTok{# each iteration, and the third dataframe contains the evaluation of the diagnosis}
\NormalTok{run_simulation <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(full_dataset, iterations, n_sample, n_diagnostic_symptoms, n_symptom_cutoff, male_percent)\{}
  \CommentTok{# run first round, possible individual subset criterium}
\NormalTok{  test_vec1 <-}\StringTok{ }\KeywordTok{diagnostic_criteria_model}\NormalTok{(full_dataset,  n_sample, n_diagnostic_symptoms, }\DecValTok{1}\NormalTok{, full_dataset}\OperatorTok{$}\NormalTok{ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}
\NormalTok{  test_data1 <-}\StringTok{ }\KeywordTok{diagnostic_model}\NormalTok{(full_dataset, test_vec1, n_symptom_cutoff)}
  \CommentTok{# create data frame for diagnostic vectors}
\NormalTok{  diagnostic_vector_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\StringTok{"round"}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(test_vec1))}
  \CommentTok{# run x iterations}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ (}\DecValTok{1}\OperatorTok{:}\NormalTok{iterations))\{}
\NormalTok{    test_vec2 <-}\StringTok{ }\KeywordTok{diagnostic_criteria_model}\NormalTok{(test_data1, n_sample, n_diagnostic_symptoms, male_percent, (test_data1[,i}\OperatorTok{+}\DecValTok{13}\NormalTok{]) }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{)}
\NormalTok{    test_data1 <-}\StringTok{ }\KeywordTok{diagnostic_model}\NormalTok{(test_data1, test_vec2, n_symptom_cutoff)}
    \CommentTok{# add new symptoms to diagnostic vector dataframe}
\NormalTok{    diagnostic_vector_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(diagnostic_vector_data, }\DataTypeTok{round =}\NormalTok{ test_vec2)}
\NormalTok{  \}}
\NormalTok{  eval <-}\StringTok{ }\KeywordTok{evaluate_diagnosis}\NormalTok{(test_data1)}
\NormalTok{  gender <-}\StringTok{ }\NormalTok{test_data1[,}\StringTok{"gender"}\NormalTok{]}
  \CommentTok{#ASD <- test_data1[,"ASD"] # REMOVE}
\NormalTok{  eval <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(gender, eval)}
  \CommentTok{# bind results in list of dataframes}
\NormalTok{  results <-}\StringTok{ }\KeywordTok{list}\NormalTok{(test_data1, diagnostic_vector_data, eval)}
  \KeywordTok{return}\NormalTok{(results)}
\NormalTok{\}}



\NormalTok{############# SECTION 2 - functions for evaluating outcome ##################}

\CommentTok{# in this section I define functions for restructuring and evaluating the data from a simulation of n iterations}

\CommentTok{# Function for determining amount of FP's, FN's, TP's, and TN's between the genders for every iteration}
\CommentTok{# takes one parameter: the evaluation dataframe from run_simulation()}
\CommentTok{# Returns list, where first element is the long format dataframe evaluating number of TP's, FP's, TN's, and FN's}
\CommentTok{# in each iteration of the algorithm. List element 2 is exlusively male individuals, and element 3 is females}
\NormalTok{evaluation_long <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(evaluation_df)\{}
  \CommentTok{# males}
\NormalTok{  m_data <-}\StringTok{ }\NormalTok{evaluation_df }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{)}
\NormalTok{  evaluation_m <-}\StringTok{ }\NormalTok{m_data[,}\DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(m_data))]}
\NormalTok{  count_data_m <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (column }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(evaluation_m))\{}
\NormalTok{    iteration <-}\StringTok{ }\NormalTok{evaluation_m[,column]}
\NormalTok{    count_table <-}\StringTok{ }\NormalTok{iteration }\OperatorTok{%>%}\StringTok{ }\KeywordTok{unlist}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{table}\NormalTok{()}
    \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{any}\NormalTok{(}\StringTok{"FP"} \OperatorTok{==}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(count_table)))\{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP =}\NormalTok{ count_table[[}\StringTok{"FP"}\NormalTok{]], }\DataTypeTok{TN =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP =} \DecValTok{0}\NormalTok{, }\DataTypeTok{TN =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
\NormalTok{    count_data_m <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(count_data_m, temp_data)}
\NormalTok{  \}}
\NormalTok{  count_data_m <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(count_data_m, }\DataTypeTok{gender =} \KeywordTok{c}\NormalTok{(}\StringTok{"M"}\NormalTok{))}
  \CommentTok{# females}
\NormalTok{  f_data <-}\StringTok{ }\NormalTok{evaluation_df }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{)}
\NormalTok{  evaluation_f <-}\StringTok{ }\NormalTok{f_data[,}\DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(f_data))]}
\NormalTok{  count_data_f <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (column }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(evaluation_f))\{}
\NormalTok{    iteration <-}\StringTok{ }\NormalTok{evaluation_f[,column]}
\NormalTok{    count_table <-}\StringTok{ }\NormalTok{iteration }\OperatorTok{%>%}\StringTok{ }\KeywordTok{unlist}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{table}\NormalTok{()}
    \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{any}\NormalTok{(}\StringTok{"FP"} \OperatorTok{==}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(count_table)))\{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP =}\NormalTok{ count_table[[}\StringTok{"FP"}\NormalTok{]], }\DataTypeTok{TN =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP =} \DecValTok{0}\NormalTok{, }\DataTypeTok{TN =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
\NormalTok{    count_data_f <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(count_data_f, temp_data)}
\NormalTok{  \}}
\NormalTok{  count_data_f <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(count_data_f, }\DataTypeTok{gender =} \KeywordTok{c}\NormalTok{(}\StringTok{"F"}\NormalTok{))}
  \CommentTok{# restructure}
\NormalTok{  all_count_data_long <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(count_data_f, count_data_m)}
\NormalTok{  id_int <-}\StringTok{ }\KeywordTok{nrow}\NormalTok{(all_count_data_long)}\OperatorTok{/}\DecValTok{2}
\NormalTok{  id_vec <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{id_int,}\DecValTok{1}\OperatorTok{:}\NormalTok{id_int)}
\NormalTok{  all_count_data_long <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(all_count_data_long, id_vec)}
  \CommentTok{# create list of data frames}
\NormalTok{  count_list <-}\StringTok{ }\KeywordTok{list}\NormalTok{(all_count_data_long, count_data_m, count_data_f)}
  
  \KeywordTok{return}\NormalTok{(count_list)}
\NormalTok{\}}


\CommentTok{# Function virtually identical to count_evaluation_long() except it returns the evaluation in (a type of) wide format used for plotting}
\NormalTok{evaluation_wide <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(evaluation_df)\{}
  \CommentTok{# males}
\NormalTok{  m_data <-}\StringTok{ }\NormalTok{evaluation_df }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{)}
\NormalTok{  evaluation_m <-}\StringTok{ }\NormalTok{m_data[,}\DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(m_data))]}
\NormalTok{  count_data_m <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (column }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(evaluation_m))\{}
\NormalTok{    iteration <-}\StringTok{ }\NormalTok{evaluation_m[,column]}
\NormalTok{    count_table <-}\StringTok{ }\NormalTok{iteration }\OperatorTok{%>%}\StringTok{ }\KeywordTok{unlist}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{table}\NormalTok{()}
    \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{any}\NormalTok{(}\StringTok{"FP"} \OperatorTok{==}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(count_table)))\{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_m =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP_m =}\NormalTok{ count_table[[}\StringTok{"FP"}\NormalTok{]], }\DataTypeTok{TN_m =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP_m =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_m =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP_m =} \DecValTok{0}\NormalTok{, }\DataTypeTok{TN_m =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP_m =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
\NormalTok{    count_data_m <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(count_data_m, temp_data)}
\NormalTok{  \}}
\NormalTok{  count_data_m <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(count_data_m, }\DataTypeTok{gender =} \KeywordTok{c}\NormalTok{(}\StringTok{"M"}\NormalTok{))}
  \CommentTok{# females}
\NormalTok{  f_data <-}\StringTok{ }\NormalTok{evaluation_df }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{)}
\NormalTok{  evaluation_f <-}\StringTok{ }\NormalTok{f_data[,}\DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(f_data))]}
\NormalTok{  count_data_f <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (column }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(evaluation_f))\{}
\NormalTok{    iteration <-}\StringTok{ }\NormalTok{evaluation_f[,column]}
\NormalTok{    count_table <-}\StringTok{ }\NormalTok{iteration }\OperatorTok{%>%}\StringTok{ }\KeywordTok{unlist}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{table}\NormalTok{()}
    \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{any}\NormalTok{(}\StringTok{"FP"} \OperatorTok{==}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(count_table)))\{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_f =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP_f =}\NormalTok{ count_table[[}\StringTok{"FP"}\NormalTok{]], }\DataTypeTok{TN_f =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP_f =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      temp_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_f =}\NormalTok{ count_table[[}\StringTok{"FN"}\NormalTok{]], }\DataTypeTok{FP_f =} \DecValTok{0}\NormalTok{, }\DataTypeTok{TN_f =}\NormalTok{ count_table[[}\StringTok{"TN"}\NormalTok{]], }\DataTypeTok{TP_f =}\NormalTok{ count_table[[}\StringTok{"TP"}\NormalTok{]])}
\NormalTok{      \}}
\NormalTok{    count_data_f <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(count_data_f, temp_data)}
\NormalTok{  \}}
\NormalTok{  count_data_f <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(count_data_f, }\DataTypeTok{gender =} \KeywordTok{c}\NormalTok{(}\StringTok{"F"}\NormalTok{))}
  \CommentTok{# restructure}
\NormalTok{  all_count_data_wide <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(count_data_f, count_data_m)}
\NormalTok{  all_count_data_wide <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(all_count_data_wide[,}\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{], all_count_data_wide[,}\DecValTok{6}\OperatorTok{:}\DecValTok{9}\NormalTok{])}
  \CommentTok{# create list of data frames}
\NormalTok{  count_list <-}\StringTok{ }\KeywordTok{list}\NormalTok{(all_count_data_wide, count_data_m, count_data_f)}
  
  \KeywordTok{return}\NormalTok{(count_list)}
\NormalTok{  \}}


\CommentTok{# Function that calculates the percentages of groups (TP, FN, TN, FP) for every iteration}
\CommentTok{# Takes the evaluation data frame from the run_simulation() function as the parameter}
\NormalTok{percentage_converter_all <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(evaluation_df)\{}
\NormalTok{  eval <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(evaluation_df)}
  \CommentTok{# males}
\NormalTok{  eval_m <-}\StringTok{ }\NormalTok{eval[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{  eval_m <-}\StringTok{ }\NormalTok{eval_m[,}\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{]}
\NormalTok{  m_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(eval_m))\{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eval_m))\{}
\NormalTok{      cell <-}\StringTok{ }\NormalTok{eval_m[j,i]}
\NormalTok{      row <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(eval_m[j,])}
\NormalTok{      percent <-}\StringTok{ }\NormalTok{cell}\OperatorTok{/}\NormalTok{(row}\OperatorTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{      m_percentage[j,i] <-}\StringTok{ }\NormalTok{percent}
\NormalTok{    \}}
\NormalTok{  \}}
  \CommentTok{# females}
\NormalTok{  eval_f <-}\StringTok{ }\NormalTok{eval[[}\DecValTok{3}\NormalTok{]]}
\NormalTok{  eval_f <-}\StringTok{ }\NormalTok{eval_f[,}\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{]}
\NormalTok{  f_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(eval_f))\{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eval_f))\{}
\NormalTok{      cell <-}\StringTok{ }\NormalTok{eval_f[j,i]}
\NormalTok{      row <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(eval_f[j,])}
\NormalTok{      percent <-}\StringTok{ }\NormalTok{cell}\OperatorTok{/}\NormalTok{(row}\OperatorTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{      f_percentage[j,i] <-}\StringTok{ }\NormalTok{percent}
\NormalTok{    \}}
\NormalTok{  \}}
  \CommentTok{# make dataframe}
\NormalTok{  all_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_f =}\NormalTok{ f_percentage[,}\DecValTok{1}\NormalTok{], }\DataTypeTok{FP_f =}\NormalTok{ f_percentage[,}\DecValTok{2}\NormalTok{], }\DataTypeTok{TN_f =}\NormalTok{ f_percentage[,}\DecValTok{3}\NormalTok{], }\DataTypeTok{TP_f =}\NormalTok{ f_percentage[,}\DecValTok{4}\NormalTok{],}\DataTypeTok{FN_m =}\NormalTok{ m_percentage[,}\DecValTok{1}\NormalTok{], }\DataTypeTok{FP_m =}\NormalTok{ m_percentage[,}\DecValTok{2}\NormalTok{], }\DataTypeTok{TN_m =}\NormalTok{ m_percentage[,}\DecValTok{3}\NormalTok{], }\DataTypeTok{TP_m =}\NormalTok{ m_percentage[,}\DecValTok{4}\NormalTok{])}

  \KeywordTok{return}\NormalTok{(all_percentage)}
\NormalTok{\}}


\CommentTok{# Functions that calculates how many percent of individuals with ASD have (TP) and have not (FN) gotten their diagnoses}
\CommentTok{# for every iteration. Takes the evaluation data frame from the run_simulation() function as the parameter}
\NormalTok{percentage_converter_ASD <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(evaluation_df)\{}
\NormalTok{  eval <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(evaluation_df)}
  \CommentTok{# males}
\NormalTok{  eval_m <-}\StringTok{ }\NormalTok{eval[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{  eval_m <-}\StringTok{ }\NormalTok{eval_m[,}\KeywordTok{c}\NormalTok{(}\StringTok{"FN_m"}\NormalTok{, }\StringTok{"TP_m"}\NormalTok{)]}
\NormalTok{  m_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(eval_m))\{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eval_m))\{}
\NormalTok{      cell <-}\StringTok{ }\NormalTok{eval_m[j,i]}
\NormalTok{      row <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(eval_m[j,])}
\NormalTok{      percent <-}\StringTok{ }\NormalTok{cell}\OperatorTok{/}\NormalTok{(row}\OperatorTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{      m_percentage[j,i] <-}\StringTok{ }\NormalTok{percent}
\NormalTok{    \}}
\NormalTok{  \}}
  \CommentTok{# females}
\NormalTok{  eval_f <-}\StringTok{ }\NormalTok{eval[[}\DecValTok{3}\NormalTok{]]}
\NormalTok{  eval_f <-}\StringTok{ }\NormalTok{eval_f[,}\KeywordTok{c}\NormalTok{(}\StringTok{"FN_f"}\NormalTok{, }\StringTok{"TP_f"}\NormalTok{)]}
\NormalTok{  f_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(eval_f))\{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eval_f))\{}
\NormalTok{      cell <-}\StringTok{ }\NormalTok{eval_f[j,i]}
\NormalTok{      row <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(eval_f[j,])}
\NormalTok{      percent <-}\StringTok{ }\NormalTok{cell}\OperatorTok{/}\NormalTok{(row}\OperatorTok{/}\DecValTok{100}\NormalTok{)}
\NormalTok{      f_percentage[j,i] <-}\StringTok{ }\NormalTok{percent}
\NormalTok{    \}}
\NormalTok{  \}}
  \CommentTok{# make dataframe}
\NormalTok{  ASD_percentage <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{FN_f =}\NormalTok{ f_percentage[, }\DecValTok{1}\NormalTok{], }\DataTypeTok{TP_f =}\NormalTok{ f_percentage[, }\DecValTok{2}\NormalTok{], }\DataTypeTok{FN_m =}\NormalTok{ m_percentage[, }\DecValTok{1}\NormalTok{], }\DataTypeTok{TP_m =}\NormalTok{ m_percentage[,}\DecValTok{2}\NormalTok{])}
  
  \KeywordTok{return}\NormalTok{(ASD_percentage)}
\NormalTok{\}}


\CommentTok{# Function determining which symptoms have been part of the diagnostic criteria for each iteration}
\CommentTok{# It creates a matrix used for plotting and takes a dataframe of the diagnostic_vectors from the run_simulation() function as the parameter}
\NormalTok{find_diagnostic_symptoms <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(diagnostic_vectors)\{}
\NormalTok{  null_vec <-}\StringTok{ }\KeywordTok{rep.int}\NormalTok{(}\DecValTok{0}\NormalTok{, }\KeywordTok{ncol}\NormalTok{(diagnostic_vectors))}
\NormalTok{  all_diagnostic_vectors <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{S1 =}\NormalTok{ null_vec, }\DataTypeTok{S2 =}\NormalTok{ null_vec, }\DataTypeTok{S3 =}\NormalTok{ null_vec, }\DataTypeTok{S4 =}\NormalTok{ null_vec, }\DataTypeTok{S5 =}\NormalTok{ null_vec, }\DataTypeTok{S6 =}\NormalTok{ null_vec, }\DataTypeTok{S7 =}\NormalTok{ null_vec, }\DataTypeTok{S8 =}\NormalTok{ null_vec, }\DataTypeTok{S9 =}\NormalTok{ null_vec)}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(diagnostic_vectors))\{}
    \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(diagnostic_vectors))\{}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S1"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S1"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S2"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S2"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S3"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S3"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S4"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S4"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S5"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S5"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S6"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S6"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S7"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S7"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S8"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S8"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
      \ControlFlowTok{if}\NormalTok{ (diagnostic_vectors[j,i] }\OperatorTok{==}\StringTok{ "S9"}\NormalTok{)\{}
\NormalTok{        all_diagnostic_vectors[i,}\StringTok{"S9"}\NormalTok{] <-}\StringTok{ }\DecValTok{1}
\NormalTok{      \}}
\NormalTok{    \}    }
\NormalTok{  \}}
\NormalTok{  matrix_vectors <-}\StringTok{ }\KeywordTok{data.matrix}\NormalTok{(all_diagnostic_vectors, }\DataTypeTok{rownames.force =} \OtherTok{NA}\NormalTok{)}

  \KeywordTok{return}\NormalTok{(matrix_vectors)}
\NormalTok{\}}



\NormalTok{############# ANALYSIS 1.a ################}

\NormalTok{### Generate data 1.a }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms (in this round of the simulation, correlations are homogenous and independent of gender)}
\NormalTok{SymptomCorr12 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr14 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr18 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr23 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr38 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr45 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr89 =}\StringTok{ }\FloatTok{0.05}

\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_1a <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}

\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_1a[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 1.a }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_1a <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_1a)}

\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2                S3         
##  Min.   :  1.00   M:200   Min.   :-0.8271   Min.   :-0.3010   Min.   :-0.5065  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.4132   1st Qu.: 0.4194   1st Qu.: 0.4045  
##  Median :100.50           Median : 0.6984   Median : 0.6320   Median : 0.6784  
##  Mean   :100.50           Mean   : 0.6745   Mean   : 0.6431   Mean   : 0.6753  
##  3rd Qu.:150.25           3rd Qu.: 0.9431   3rd Qu.: 0.9030   3rd Qu.: 0.9443  
##  Max.   :200.00           Max.   : 2.1392   Max.   : 1.7399   Max.   : 1.7368  
##        S4                S5                S6                S7          
##  Min.   :-0.6654   Min.   :-0.4652   Min.   :-0.5327   Min.   :-0.65389  
##  1st Qu.: 0.2631   1st Qu.: 0.2118   1st Qu.: 0.2667   1st Qu.: 0.09825  
##  Median : 0.5045   Median : 0.4953   Median : 0.5137   Median : 0.32548  
##  Mean   : 0.5167   Mean   : 0.5138   Mean   : 0.5015   Mean   : 0.32375  
##  3rd Qu.: 0.7840   3rd Qu.: 0.8032   3rd Qu.: 0.7444   3rd Qu.: 0.64091  
##  Max.   : 1.6112   Max.   : 1.6430   Max.   : 1.3777   Max.   : 1.27925  
##        S8                S9              symptoms        ASD       
##  Min.   :-0.7493   Min.   :-0.88380   Min.   :0.0   Min.   :0.000  
##  1st Qu.: 0.0532   1st Qu.: 0.05404   1st Qu.:4.0   1st Qu.:0.000  
##  Median : 0.2498   Median : 0.27973   Median :5.0   Median :0.000  
##  Mean   : 0.2834   Mean   : 0.30291   Mean   :5.3   Mean   :0.485  
##  3rd Qu.: 0.5249   3rd Qu.: 0.55437   3rd Qu.:7.0   3rd Qu.:1.000  
##  Max.   : 1.2947   Max.   : 1.21572   Max.   :9.0   Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1                 S2                S3         
##  Min.   :  1.0   M:97   Min.   :-0.02561   Min.   :-0.1090   Min.   :0.05387  
##  1st Qu.: 47.0   F: 0   1st Qu.: 0.67485   1st Qu.: 0.5473   1st Qu.:0.62570  
##  Median :101.0          Median : 0.82537   Median : 0.8154   Median :0.84149  
##  Mean   :100.9          Mean   : 0.86397   Mean   : 0.8086   Mean   :0.83697  
##  3rd Qu.:151.0          3rd Qu.: 1.05116   3rd Qu.: 1.0335   3rd Qu.:1.05202  
##  Max.   :200.0          Max.   : 2.13924   Max.   : 1.7399   Max.   :1.73682  
##        S4                S5                 S6                S7         
##  Min.   :-0.1146   Min.   :-0.02174   Min.   :-0.2106   Min.   :-0.4753  
##  1st Qu.: 0.4408   1st Qu.: 0.51664   1st Qu.: 0.4655   1st Qu.: 0.2243  
##  Median : 0.6189   Median : 0.71924   Median : 0.6640   Median : 0.4491  
##  Mean   : 0.6839   Mean   : 0.73168   Mean   : 0.6398   Mean   : 0.4713  
##  3rd Qu.: 0.9173   3rd Qu.: 0.94190   3rd Qu.: 0.8410   3rd Qu.: 0.7344  
##  Max.   : 1.6112   Max.   : 1.64295   Max.   : 1.3777   Max.   : 1.2024  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.3596   Min.   :-0.3456   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.2381   1st Qu.: 0.2605   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.4905   Median : 0.5070   Median :7.000   Median :1  
##  Mean   : 0.4781   Mean   : 0.4936   Mean   :7.155   Mean   :1  
##  3rd Qu.: 0.7413   3rd Qu.: 0.7562   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.2947   Max.   : 1.2157   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :  2.0   M:103   Min.   :-0.8271   Min.   :-0.3010   Min.   :-0.5065  
##  1st Qu.: 57.0   F:  0   1st Qu.: 0.2711   1st Qu.: 0.2593   1st Qu.: 0.2692  
##  Median : 97.0           Median : 0.5126   Median : 0.4810   Median : 0.5023  
##  Mean   :100.2           Mean   : 0.4961   Mean   : 0.4872   Mean   : 0.5231  
##  3rd Qu.:147.5           3rd Qu.: 0.7521   3rd Qu.: 0.7488   3rd Qu.: 0.7965  
##  Max.   :197.0           Max.   : 1.3682   Max.   : 1.5957   Max.   : 1.4971  
##        S4                S5                 S6                S7          
##  Min.   :-0.6654   Min.   :-0.46517   Min.   :-0.5327   Min.   :-0.65389  
##  1st Qu.: 0.1438   1st Qu.: 0.06253   1st Qu.: 0.1333   1st Qu.:-0.07885  
##  Median : 0.3176   Median : 0.27041   Median : 0.4224   Median : 0.18530  
##  Mean   : 0.3592   Mean   : 0.30862   Mean   : 0.3713   Mean   : 0.18482  
##  3rd Qu.: 0.6028   3rd Qu.: 0.50060   3rd Qu.: 0.6159   3rd Qu.: 0.38457  
##  Max.   : 1.1988   Max.   : 1.22357   Max.   : 1.0845   Max.   : 1.27925  
##        S8                S9              symptoms          ASD   
##  Min.   :-0.7493   Min.   :-0.88380   Min.   :0.000   Min.   :0  
##  1st Qu.:-0.1082   1st Qu.:-0.05794   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.1056   Median : 0.14489   Median :4.000   Median :0  
##  Mean   : 0.1001   Mean   : 0.12333   Mean   :3.553   Mean   :0  
##  3rd Qu.: 0.2890   3rd Qu.: 0.30763   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.0636   Max.   : 1.17662   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3          
##  Min.   :201.0   M:  0   Min.   :-0.6396   Min.   :-0.7398   Min.   :-0.97219  
##  1st Qu.:250.8   F:200   1st Qu.: 0.3858   1st Qu.: 0.2533   1st Qu.: 0.01571  
##  Median :300.5           Median : 0.7058   Median : 0.5066   Median : 0.32474  
##  Mean   :300.5           Mean   : 0.6702   Mean   : 0.5151   Mean   : 0.29015  
##  3rd Qu.:350.2           3rd Qu.: 0.9774   3rd Qu.: 0.7954   3rd Qu.: 0.58285  
##  Max.   :400.0           Max.   : 1.9619   Max.   : 1.5072   Max.   : 1.19904  
##        S4                S5                S6                 S7         
##  Min.   :-0.6583   Min.   :-0.4306   Min.   :-1.18604   Min.   :-0.6816  
##  1st Qu.: 0.4274   1st Qu.: 0.2081   1st Qu.: 0.07167   1st Qu.: 0.4442  
##  Median : 0.7018   Median : 0.5091   Median : 0.35764   Median : 0.7245  
##  Mean   : 0.6992   Mean   : 0.5104   Mean   : 0.31428   Mean   : 0.7293  
##  3rd Qu.: 0.9740   3rd Qu.: 0.8404   3rd Qu.: 0.58762   3rd Qu.: 0.9631  
##  Max.   : 1.8036   Max.   : 1.4854   Max.   : 1.68352   Max.   : 2.3429  
##        S8                S9              symptoms         ASD      
##  Min.   :-0.4187   Min.   :-0.84718   Min.   :0.00   Min.   :0.00  
##  1st Qu.: 0.1398   1st Qu.: 0.05484   1st Qu.:4.00   1st Qu.:0.00  
##  Median : 0.4295   Median : 0.34079   Median :6.00   Median :1.00  
##  Mean   : 0.4631   Mean   : 0.30420   Mean   :5.38   Mean   :0.54  
##  3rd Qu.: 0.7296   3rd Qu.: 0.59522   3rd Qu.:7.00   3rd Qu.:1.00  
##  Max.   : 1.5902   Max.   : 1.39338   Max.   :9.00   Max.   :1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                 S3         
##  Min.   :203.0   M:  0   Min.   :-0.1215   Min.   :-0.08937   Min.   :-0.5684  
##  1st Qu.:254.8   F:108   1st Qu.: 0.6234   1st Qu.: 0.46936   1st Qu.: 0.1607  
##  Median :302.5           Median : 0.8642   Median : 0.61465   Median : 0.4682  
##  Mean   :303.6           Mean   : 0.8768   Mean   : 0.68093   Mean   : 0.4347  
##  3rd Qu.:353.8           3rd Qu.: 1.0816   3rd Qu.: 0.92562   3rd Qu.: 0.7246  
##  Max.   :400.0           Max.   : 1.9619   Max.   : 1.50719   Max.   : 1.1990  
##        S4                S5                S6                S7        
##  Min.   :0.00817   Min.   :-0.2483   Min.   :-0.3369   Min.   :0.2115  
##  1st Qu.:0.63182   1st Qu.: 0.4602   1st Qu.: 0.2965   1st Qu.:0.6815  
##  Median :0.83105   Median : 0.6711   Median : 0.5228   Median :0.9073  
##  Mean   :0.83914   Mean   : 0.6766   Mean   : 0.5183   Mean   :0.9327  
##  3rd Qu.:1.07077   3rd Qu.: 0.9508   3rd Qu.: 0.6858   3rd Qu.:1.1138  
##  Max.   :1.80365   Max.   : 1.4854   Max.   : 1.6835   Max.   :2.3429  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.0934   Min.   :-0.2530   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.4214   1st Qu.: 0.2816   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.6372   Median : 0.4683   Median :7.000   Median :1  
##  Mean   : 0.6474   Mean   : 0.4686   Mean   :7.139   Mean   :1  
##  3rd Qu.: 0.8645   3rd Qu.: 0.7009   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.5902   Max.   : 1.3934   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_1a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1                S2                 S3         
##  Min.   :201.0   M: 0   Min.   :-0.6396   Min.   :-0.73984   Min.   :-0.9722  
##  1st Qu.:242.5   F:92   1st Qu.: 0.1525   1st Qu.: 0.06867   1st Qu.:-0.1664  
##  Median :297.5          Median : 0.3872   Median : 0.29294   Median : 0.1754  
##  Mean   :296.8          Mean   : 0.4276   Mean   : 0.32039   Mean   : 0.1205  
##  3rd Qu.:346.5          3rd Qu.: 0.7624   3rd Qu.: 0.62020   3rd Qu.: 0.3992  
##  Max.   :397.0          Max.   : 1.3817   Max.   : 1.16841   Max.   : 0.9472  
##        S4                S5                 S6                 S7         
##  Min.   :-0.6583   Min.   :-0.43062   Min.   :-1.18604   Min.   :-0.6816  
##  1st Qu.: 0.2556   1st Qu.: 0.06156   1st Qu.:-0.10287   1st Qu.: 0.2563  
##  Median : 0.5429   Median : 0.26656   Median : 0.15191   Median : 0.4700  
##  Mean   : 0.5349   Mean   : 0.31530   Mean   : 0.07474   Mean   : 0.4904  
##  3rd Qu.: 0.7939   3rd Qu.: 0.53488   3rd Qu.: 0.36303   3rd Qu.: 0.7410  
##  Max.   : 1.6283   Max.   : 1.27952   Max.   : 0.68139   Max.   : 1.5435  
##        S8                 S9             symptoms          ASD   
##  Min.   :-0.41867   Min.   :-0.8472   Min.   :0.000   Min.   :0  
##  1st Qu.: 0.02611   1st Qu.:-0.1408   1st Qu.:2.000   1st Qu.:0  
##  Median : 0.18604   Median : 0.1470   Median :3.500   Median :0  
##  Mean   : 0.24680   Mean   : 0.1112   Mean   :3.315   Mean   :0  
##  3rd Qu.: 0.41292   3rd Qu.: 0.3600   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.58921   Max.   : 1.0103   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 50 % males in diagnostic updating sample}
\NormalTok{results_1a <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_1a, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \FloatTok{0.5}\NormalTok{)}

\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_1a <-}\StringTok{ }\NormalTok{results_1a[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_1a <-}\StringTok{ }\NormalTok{results_1a[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_1a <-}\StringTok{ }\NormalTok{results_1a[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 1.a }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_1a <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_1a)}
\NormalTok{long_1a <-}\StringTok{ }\NormalTok{eval_long_1a[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_1a <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_1a)}
\NormalTok{wide_1a <-}\StringTok{ }\NormalTok{eval_wide_1a[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_1a <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_1a)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_1a <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_1a)}


\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_1a <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_1a)}



\NormalTok{### Visualizations via plots and graphs 1.a }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 1.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 1.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
  \KeywordTok{ggplot}\NormalTok{(wide_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 1.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
  \KeywordTok{ggplot}\NormalTok{(wide_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 1.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 1.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 1.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of Female FN's, 1.a, third run"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1a), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 1.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_1a, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, 1.a, third run"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-10.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{############# ANALYSIS 1.b ################}

\NormalTok{### Generate data 1.b }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms (in this round of the simulation, correlations are homogenous and independent of gender)}
\NormalTok{SymptomCorr12 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr14 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr18 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr23 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr38 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr45 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr89 =}\StringTok{ }\FloatTok{0.05}

\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_1b <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}


\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_1b[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-11.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 1.b }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_1b <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_1b)}


\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2         
##  Min.   :  1.00   M:200   Min.   :-0.5386   Min.   :-0.8816  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.4478   1st Qu.: 0.5166  
##  Median :100.50           Median : 0.7735   Median : 0.7533  
##  Mean   :100.50           Mean   : 0.7316   Mean   : 0.7428  
##  3rd Qu.:150.25           3rd Qu.: 1.0209   3rd Qu.: 0.9688  
##  Max.   :200.00           Max.   : 1.9398   Max.   : 2.0530  
##        S3                 S4                S5                S6         
##  Min.   :-0.06942   Min.   :-0.1994   Min.   :-0.4940   Min.   :-0.5022  
##  1st Qu.: 0.49990   1st Qu.: 0.2252   1st Qu.: 0.2873   1st Qu.: 0.2882  
##  Median : 0.77795   Median : 0.4962   Median : 0.5377   Median : 0.5606  
##  Mean   : 0.77262   Mean   : 0.5022   Mean   : 0.5086   Mean   : 0.5564  
##  3rd Qu.: 1.04979   3rd Qu.: 0.7628   3rd Qu.: 0.7915   3rd Qu.: 0.8427  
##  Max.   : 1.77989   Max.   : 1.5616   Max.   : 1.5530   Max.   : 1.5074  
##        S7                 S8                 S9              symptoms    
##  Min.   :-0.98796   Min.   :-0.38388   Min.   :-0.47608   Min.   :0.000  
##  1st Qu.: 0.03322   1st Qu.: 0.01983   1st Qu.: 0.04639   1st Qu.:4.000  
##  Median : 0.32256   Median : 0.28905   Median : 0.32994   Median :6.000  
##  Mean   : 0.31753   Mean   : 0.34425   Mean   : 0.32482   Mean   :5.585  
##  3rd Qu.: 0.61407   3rd Qu.: 0.59876   3rd Qu.: 0.62585   3rd Qu.:7.000  
##  Max.   : 1.53412   Max.   : 1.67417   Max.   : 1.42455   Max.   :9.000  
##       ASD       
##  Min.   :0.000  
##  1st Qu.:0.000  
##  Median :1.000  
##  Mean   :0.565  
##  3rd Qu.:1.000  
##  Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2               S3        
##  Min.   :  1.0   M:113   Min.   :-0.5386   Min.   :0.1750   Min.   :0.1966  
##  1st Qu.: 46.0   F:  0   1st Qu.: 0.6674   1st Qu.:0.6484   1st Qu.:0.7355  
##  Median : 91.0           Median : 0.8754   Median :0.8786   Median :0.9284  
##  Mean   : 93.5           Mean   : 0.8597   Mean   :0.8830   Mean   :0.9257  
##  3rd Qu.:138.0           3rd Qu.: 1.0880   3rd Qu.:1.1255   3rd Qu.:1.1131  
##  Max.   :199.0           Max.   : 1.9398   Max.   :2.0530   Max.   :1.7799  
##        S4                S5                S6                S7         
##  Min.   :-0.1036   Min.   :-0.4395   Min.   :-0.2440   Min.   :-0.2952  
##  1st Qu.: 0.4437   1st Qu.: 0.5220   1st Qu.: 0.5262   1st Qu.: 0.2319  
##  Median : 0.6195   Median : 0.6852   Median : 0.7128   Median : 0.5323  
##  Mean   : 0.6649   Mean   : 0.6929   Mean   : 0.7335   Mean   : 0.4821  
##  3rd Qu.: 0.9065   3rd Qu.: 0.8855   3rd Qu.: 0.9797   3rd Qu.: 0.7583  
##  Max.   : 1.5616   Max.   : 1.4316   Max.   : 1.5074   Max.   : 1.5341  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.3762   Min.   :-0.4277   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.2289   1st Qu.: 0.1824   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.5133   Median : 0.4950   Median :7.000   Median :1  
##  Mean   : 0.4886   Mean   : 0.4730   Mean   :7.168   Mean   :1  
##  3rd Qu.: 0.7419   3rd Qu.: 0.7145   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.6742   Max.   : 1.4246   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1                S2                S3          
##  Min.   :  2.0   M:87   Min.   :-0.3109   Min.   :-0.8816   Min.   :-0.06942  
##  1st Qu.: 65.5   F: 0   1st Qu.: 0.3124   1st Qu.: 0.3092   1st Qu.: 0.34799  
##  Median :119.0          Median : 0.5265   Median : 0.5943   Median : 0.54189  
##  Mean   :109.6          Mean   : 0.5652   Mean   : 0.5607   Mean   : 0.57375  
##  3rd Qu.:155.5          3rd Qu.: 0.8697   3rd Qu.: 0.8142   3rd Qu.: 0.78513  
##  Max.   :200.0          Max.   : 1.4564   Max.   : 1.4113   Max.   : 1.53280  
##        S4                 S5                 S6                S7          
##  Min.   :-0.19938   Min.   :-0.49400   Min.   :-0.5022   Min.   :-0.98796  
##  1st Qu.: 0.04212   1st Qu.: 0.03205   1st Qu.: 0.1314   1st Qu.:-0.08135  
##  Median : 0.24815   Median : 0.29407   Median : 0.3320   Median : 0.10986  
##  Mean   : 0.29090   Mean   : 0.26930   Mean   : 0.3264   Mean   : 0.10375  
##  3rd Qu.: 0.49492   3rd Qu.: 0.49084   3rd Qu.: 0.5309   3rd Qu.: 0.33603  
##  Max.   : 1.06041   Max.   : 1.55302   Max.   : 1.4071   Max.   : 1.02784  
##        S8                 S9              symptoms          ASD   
##  Min.   :-0.38388   Min.   :-0.47608   Min.   :0.000   Min.   :0  
##  1st Qu.:-0.07161   1st Qu.:-0.09254   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.14469   Median : 0.13721   Median :4.000   Median :0  
##  Mean   : 0.15677   Mean   : 0.13231   Mean   :3.529   Mean   :0  
##  3rd Qu.: 0.29769   3rd Qu.: 0.35135   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.27440   Max.   : 1.11560   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :201.0   M:  0   Min.   :-0.3331   Min.   :-0.3594   Min.   :-0.8255  
##  1st Qu.:250.8   F:200   1st Qu.: 0.4399   1st Qu.: 0.2471   1st Qu.: 0.1449  
##  Median :300.5           Median : 0.7132   Median : 0.4912   Median : 0.3347  
##  Mean   :300.5           Mean   : 0.7102   Mean   : 0.5177   Mean   : 0.3345  
##  3rd Qu.:350.2           3rd Qu.: 0.9577   3rd Qu.: 0.7995   3rd Qu.: 0.5543  
##  Max.   :400.0           Max.   : 1.7326   Max.   : 1.5781   Max.   : 1.2406  
##        S4                S5                S6                 S7         
##  Min.   :-0.2857   Min.   :-0.4515   Min.   :-0.75121   Min.   :-0.2569  
##  1st Qu.: 0.4007   1st Qu.: 0.2175   1st Qu.: 0.06898   1st Qu.: 0.4249  
##  Median : 0.7020   Median : 0.5073   Median : 0.28279   Median : 0.7241  
##  Mean   : 0.6922   Mean   : 0.5049   Mean   : 0.30616   Mean   : 0.7123  
##  3rd Qu.: 0.9452   3rd Qu.: 0.7886   3rd Qu.: 0.58015   3rd Qu.: 1.0385  
##  Max.   : 1.7731   Max.   : 1.5913   Max.   : 1.25757   Max.   : 1.7476  
##        S8                S9              symptoms         ASD     
##  Min.   :-0.4082   Min.   :-0.44533   Min.   :0.00   Min.   :0.0  
##  1st Qu.: 0.2827   1st Qu.: 0.02204   1st Qu.:4.00   1st Qu.:0.0  
##  Median : 0.5490   Median : 0.33952   Median :5.50   Median :0.5  
##  Mean   : 0.5563   Mean   : 0.30417   Mean   :5.37   Mean   :0.5  
##  3rd Qu.: 0.7961   3rd Qu.: 0.55878   3rd Qu.:7.00   3rd Qu.:1.0  
##  Max.   : 1.6097   Max.   : 1.17558   Max.   :9.00   Max.   :1.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                 S3         
##  Min.   :201.0   M:  0   Min.   :0.02151   Min.   :-0.09156   Min.   :-0.6435  
##  1st Qu.:248.8   F:100   1st Qu.:0.62615   1st Qu.: 0.47066   1st Qu.: 0.2790  
##  Median :308.0           Median :0.84572   Median : 0.74611   Median : 0.5056  
##  Mean   :302.2           Mean   :0.85026   Mean   : 0.71917   Mean   : 0.4684  
##  3rd Qu.:352.5           3rd Qu.:1.05347   3rd Qu.: 0.98652   3rd Qu.: 0.6483  
##  Max.   :400.0           Max.   :1.73263   Max.   : 1.57813   Max.   : 1.2406  
##        S4                S5                S6                S7        
##  Min.   :-0.2857   Min.   :-0.1417   Min.   :-0.3661   Min.   :0.0142  
##  1st Qu.: 0.5816   1st Qu.: 0.4954   1st Qu.: 0.2232   1st Qu.:0.6311  
##  Median : 0.8157   Median : 0.7090   Median : 0.5145   Median :0.8545  
##  Mean   : 0.8244   Mean   : 0.6937   Mean   : 0.4988   Mean   :0.8729  
##  3rd Qu.: 1.0901   3rd Qu.: 0.8756   3rd Qu.: 0.7328   3rd Qu.:1.1096  
##  Max.   : 1.7731   Max.   : 1.5913   Max.   : 1.2576   Max.   :1.7476  
##        S8                S9             symptoms         ASD   
##  Min.   :0.02466   Min.   :-0.3297   Min.   :6.00   Min.   :1  
##  1st Qu.:0.50752   1st Qu.: 0.2178   1st Qu.:6.00   1st Qu.:1  
##  Median :0.66677   Median : 0.4785   Median :7.00   Median :1  
##  Mean   :0.71955   Mean   : 0.4358   Mean   :7.09   Mean   :1  
##  3rd Qu.:0.96256   3rd Qu.: 0.6440   3rd Qu.:8.00   3rd Qu.:1  
##  Max.   :1.60975   Max.   : 1.1756   Max.   :9.00   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_1b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2          
##  Min.   :206.0   M:  0   Min.   :-0.3331   Min.   :-0.35942  
##  1st Qu.:253.8   F:100   1st Qu.: 0.3273   1st Qu.: 0.08457  
##  Median :293.0           Median : 0.5842   Median : 0.27306  
##  Mean   :298.8           Mean   : 0.5701   Mean   : 0.31614  
##  3rd Qu.:345.8           3rd Qu.: 0.8239   3rd Qu.: 0.52762  
##  Max.   :399.0           Max.   : 1.4742   Max.   : 1.07324  
##        S3                 S4                S5                 S6         
##  Min.   :-0.82553   Min.   :-0.2692   Min.   :-0.45149   Min.   :-0.7512  
##  1st Qu.: 0.05157   1st Qu.: 0.3188   1st Qu.: 0.09244   1st Qu.:-0.1483  
##  Median : 0.24722   Median : 0.5230   Median : 0.27264   Median : 0.1484  
##  Mean   : 0.20064   Mean   : 0.5599   Mean   : 0.31608   Mean   : 0.1135  
##  3rd Qu.: 0.35739   3rd Qu.: 0.7919   3rd Qu.: 0.58305   3rd Qu.: 0.3364  
##  Max.   : 0.98764   Max.   : 1.4411   Max.   : 1.32548   Max.   : 0.8093  
##        S7                S8                S9              symptoms   
##  Min.   :-0.2569   Min.   :-0.4082   Min.   :-0.44533   Min.   :0.00  
##  1st Qu.: 0.3002   1st Qu.: 0.1788   1st Qu.:-0.04766   1st Qu.:3.00  
##  Median : 0.5106   Median : 0.3781   Median : 0.16345   Median :4.00  
##  Mean   : 0.5517   Mean   : 0.3930   Mean   : 0.17253   Mean   :3.65  
##  3rd Qu.: 0.8179   3rd Qu.: 0.6293   3rd Qu.: 0.37117   3rd Qu.:5.00  
##  Max.   : 1.3290   Max.   : 1.3221   Max.   : 0.92674   Max.   :5.00  
##       ASD   
##  Min.   :0  
##  1st Qu.:0  
##  Median :0  
##  Mean   :0  
##  3rd Qu.:0  
##  Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 80 % males in diagnostic updating sample}
\NormalTok{results_1b <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_1b, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \FloatTok{0.8}\NormalTok{)}

\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_1b <-}\StringTok{ }\NormalTok{results_1b[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_1b <-}\StringTok{ }\NormalTok{results_1b[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_1b <-}\StringTok{ }\NormalTok{results_1b[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 1.b }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_1b <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_1b)}
\NormalTok{long_1b <-}\StringTok{ }\NormalTok{eval_long_1b[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_1b <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_1b)}
\NormalTok{wide_1b <-}\StringTok{ }\NormalTok{eval_wide_1b[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_1b <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_1b)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_1b <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_1b)}


\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_1b <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_1b)}



\NormalTok{### Visualizations via plots and graphs 1.b }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 1.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 1.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-13.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
\KeywordTok{ggplot}\NormalTok{(wide_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 1.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-14.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
\KeywordTok{ggplot}\NormalTok{(wide_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 1.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-15.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 1.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-16.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, only ASD)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 1.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-17.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, only ASD)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Females, simulation 1.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-18.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, only ASD)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1b), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 1.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-19.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_1b, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, simulation 1.b"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-20.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{############# ANALYSIS 1.c ################}

\NormalTok{### Generate data 1.c }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms (in this round of the simulation, correlations are homogenous and independent of gender)}
\NormalTok{SymptomCorr12 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr14 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr18 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr23 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr38 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr45 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79 =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr89 =}\StringTok{ }\FloatTok{0.05}

\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12, SymptomCorr13, SymptomCorr14, SymptomCorr15, SymptomCorr16, SymptomCorr17, SymptomCorr18, SymptomCorr19,}
\NormalTok{  SymptomCorr12, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23,SymptomCorr24, SymptomCorr25, SymptomCorr26, SymptomCorr27, SymptomCorr28, SymptomCorr29,}
\NormalTok{  SymptomCorr13,SymptomCorr23, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34, SymptomCorr35, SymptomCorr36, SymptomCorr37, SymptomCorr38, SymptomCorr39,}
\NormalTok{  SymptomCorr14, SymptomCorr24, SymptomCorr34, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45, SymptomCorr46, SymptomCorr47, SymptomCorr48, SymptomCorr49,}
\NormalTok{  SymptomCorr15, SymptomCorr25, SymptomCorr35, SymptomCorr45, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56, SymptomCorr57, SymptomCorr58, SymptomCorr59,}
\NormalTok{  SymptomCorr16, SymptomCorr26, SymptomCorr36, SymptomCorr46, SymptomCorr56, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67, SymptomCorr68,SymptomCorr69,}
\NormalTok{  SymptomCorr17, SymptomCorr27, SymptomCorr37, SymptomCorr47, SymptomCorr57, SymptomCorr67, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78, SymptomCorr79,}
\NormalTok{  SymptomCorr18, SymptomCorr28, SymptomCorr38, SymptomCorr48, SymptomCorr58, SymptomCorr68, SymptomCorr78, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89,}
\NormalTok{  SymptomCorr19, SymptomCorr29, SymptomCorr39, SymptomCorr49, SymptomCorr59, SymptomCorr69, SymptomCorr79, SymptomCorr89, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.20041e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}

\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_1c <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}

\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_1c[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-21.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 1.c }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_1c <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_1c)}

\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2                S3         
##  Min.   :  1.00   M:200   Min.   :-0.5741   Min.   :-0.1633   Min.   :-0.7573  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.4773   1st Qu.: 0.4019   1st Qu.: 0.4300  
##  Median :100.50           Median : 0.7336   Median : 0.7028   Median : 0.7229  
##  Mean   :100.50           Mean   : 0.7159   Mean   : 0.7136   Mean   : 0.7072  
##  3rd Qu.:150.25           3rd Qu.: 0.9970   3rd Qu.: 1.0025   3rd Qu.: 0.9984  
##  Max.   :200.00           Max.   : 1.7476   Max.   : 2.0068   Max.   : 1.9637  
##        S4                S5                S6                S7          
##  Min.   :-0.3672   Min.   :-0.3208   Min.   :-0.8848   Min.   :-1.39199  
##  1st Qu.: 0.2073   1st Qu.: 0.2289   1st Qu.: 0.2119   1st Qu.: 0.05137  
##  Median : 0.4742   Median : 0.4864   Median : 0.5070   Median : 0.31336  
##  Mean   : 0.4923   Mean   : 0.4861   Mean   : 0.4607   Mean   : 0.28770  
##  3rd Qu.: 0.7480   3rd Qu.: 0.7553   3rd Qu.: 0.7603   3rd Qu.: 0.55651  
##  Max.   : 1.6108   Max.   : 1.5622   Max.   : 1.5078   Max.   : 1.24550  
##        S8                S9               symptoms          ASD       
##  Min.   :-0.6527   Min.   :-0.758379   Min.   :0.000   Min.   :0.000  
##  1st Qu.: 0.0544   1st Qu.: 0.007785   1st Qu.:4.000   1st Qu.:0.000  
##  Median : 0.3666   Median : 0.347469   Median :6.000   Median :1.000  
##  Mean   : 0.3304   Mean   : 0.308854   Mean   :5.325   Mean   :0.505  
##  3rd Qu.: 0.6286   3rd Qu.: 0.604253   3rd Qu.:7.000   3rd Qu.:1.000  
##  Max.   : 1.4519   Max.   : 1.286308   Max.   :9.000   Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                 S2                S3        
##  Min.   :  1.00   M:101   Min.   :-0.06944   Min.   :0.00418   Min.   :0.1118  
##  1st Qu.: 45.00   F:  0   1st Qu.: 0.72380   1st Qu.:0.66707   1st Qu.:0.6923  
##  Median :102.00           Median : 0.88586   Median :0.89932   Median :0.8913  
##  Mean   : 99.89           Mean   : 0.89829   Mean   :0.90788   Mean   :0.9433  
##  3rd Qu.:153.00           3rd Qu.: 1.12444   3rd Qu.:1.10870   3rd Qu.:1.1646  
##  Max.   :200.00           Max.   : 1.74758   Max.   :2.00680   Max.   :1.9637  
##        S4                S5                S6                S7         
##  Min.   :-0.3358   Min.   :-0.2983   Min.   :-0.3953   Min.   :-0.3341  
##  1st Qu.: 0.4419   1st Qu.: 0.3710   1st Qu.: 0.4653   1st Qu.: 0.2737  
##  Median : 0.6944   Median : 0.6155   Median : 0.6827   Median : 0.4958  
##  Mean   : 0.6813   Mean   : 0.6318   Mean   : 0.6571   Mean   : 0.4675  
##  3rd Qu.: 0.9076   3rd Qu.: 0.8842   3rd Qu.: 0.8878   3rd Qu.: 0.6774  
##  Max.   : 1.6108   Max.   : 1.5622   Max.   : 1.5078   Max.   : 1.2455  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.4751   Min.   :-0.4844   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.3940   1st Qu.: 0.2796   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.5962   Median : 0.5443   Median :7.000   Median :1  
##  Mean   : 0.5522   Mean   : 0.4733   Mean   :7.079   Mean   :1  
##  3rd Qu.: 0.7638   3rd Qu.: 0.7248   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.4519   Max.   : 1.2863   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1                S2                S3         
##  Min.   :  2.0   M:99   Min.   :-0.5741   Min.   :-0.1633   Min.   :-0.7573  
##  1st Qu.: 57.5   F: 0   1st Qu.: 0.3322   1st Qu.: 0.3184   1st Qu.: 0.2059  
##  Median :100.0          Median : 0.5488   Median : 0.4483   Median : 0.4866  
##  Mean   :101.1          Mean   : 0.5299   Mean   : 0.5153   Mean   : 0.4663  
##  3rd Qu.:148.0          3rd Qu.: 0.7734   3rd Qu.: 0.7084   3rd Qu.: 0.7676  
##  Max.   :199.0          Max.   : 1.3311   Max.   : 1.4197   Max.   : 1.3429  
##        S4                 S5                S6                 S7         
##  Min.   :-0.36719   Min.   :-0.3208   Min.   :-0.88477   Min.   :-1.3920  
##  1st Qu.: 0.06622   1st Qu.: 0.1397   1st Qu.: 0.02325   1st Qu.:-0.1255  
##  Median : 0.31237   Median : 0.3046   Median : 0.29355   Median : 0.1035  
##  Mean   : 0.29956   Mean   : 0.3374   Mean   : 0.26037   Mean   : 0.1043  
##  3rd Qu.: 0.50005   3rd Qu.: 0.5036   3rd Qu.: 0.51673   3rd Qu.: 0.3503  
##  Max.   : 1.15735   Max.   : 1.2814   Max.   : 1.39177   Max.   : 0.9987  
##        S8                S9              symptoms          ASD   
##  Min.   :-0.6527   Min.   :-0.75838   Min.   :0.000   Min.   :0  
##  1st Qu.:-0.1175   1st Qu.:-0.08637   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.1151   Median : 0.15970   Median :4.000   Median :0  
##  Mean   : 0.1040   Mean   : 0.14105   Mean   :3.535   Mean   :0  
##  3rd Qu.: 0.3399   3rd Qu.: 0.35832   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 0.8966   Max.   : 1.00329   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3          
##  Min.   :201.0   M:  0   Min.   :-0.3639   Min.   :-0.5380   Min.   :-1.03763  
##  1st Qu.:250.8   F:200   1st Qu.: 0.4351   1st Qu.: 0.1990   1st Qu.: 0.02141  
##  Median :300.5           Median : 0.7376   Median : 0.5155   Median : 0.27615  
##  Mean   :300.5           Mean   : 0.7141   Mean   : 0.5168   Mean   : 0.26966  
##  3rd Qu.:350.2           3rd Qu.: 0.9859   3rd Qu.: 0.7941   3rd Qu.: 0.51638  
##  Max.   :400.0           Max.   : 1.8706   Max.   : 1.7118   Max.   : 1.14377  
##        S4                S5                S6                 S7         
##  Min.   :-0.2206   Min.   :-0.4092   Min.   :-0.51031   Min.   :-0.3300  
##  1st Qu.: 0.4250   1st Qu.: 0.2069   1st Qu.: 0.09984   1st Qu.: 0.4430  
##  Median : 0.6447   Median : 0.4664   Median : 0.32310   Median : 0.6887  
##  Mean   : 0.6719   Mean   : 0.5088   Mean   : 0.31899   Mean   : 0.6896  
##  3rd Qu.: 0.8824   3rd Qu.: 0.7918   3rd Qu.: 0.55151   3rd Qu.: 0.9466  
##  Max.   : 1.6601   Max.   : 1.5820   Max.   : 1.29027   Max.   : 1.5963  
##        S8                S9             symptoms          ASD      
##  Min.   :-0.8261   Min.   :-0.7704   Min.   :0.000   Min.   :0.00  
##  1st Qu.: 0.2608   1st Qu.: 0.0103   1st Qu.:3.750   1st Qu.:0.00  
##  Median : 0.4820   Median : 0.2852   Median :5.000   Median :0.00  
##  Mean   : 0.4890   Mean   : 0.2765   Mean   :5.255   Mean   :0.49  
##  3rd Qu.: 0.7588   3rd Qu.: 0.4808   3rd Qu.:7.000   3rd Qu.:1.00  
##  Max.   : 1.4495   Max.   : 1.3614   Max.   :9.000   Max.   :1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1               S2                S3         
##  Min.   :202.0   M: 0   Min.   :0.1204   Min.   :-0.5380   Min.   :-0.2008  
##  1st Qu.:251.2   F:98   1st Qu.:0.6782   1st Qu.: 0.5288   1st Qu.: 0.2816  
##  Median :297.5          Median :0.9070   Median : 0.7282   Median : 0.4778  
##  Mean   :298.5          Mean   :0.9371   Mean   : 0.7330   Mean   : 0.4886  
##  3rd Qu.:345.8          3rd Qu.:1.1523   3rd Qu.: 0.9828   3rd Qu.: 0.7251  
##  Max.   :400.0          Max.   :1.8706   Max.   : 1.7118   Max.   : 1.1438  
##        S4                S5                S6                S7        
##  Min.   :0.06999   Min.   :-0.1567   Min.   :-0.3951   Min.   :0.2656  
##  1st Qu.:0.62304   1st Qu.: 0.4256   1st Qu.: 0.2523   1st Qu.:0.6959  
##  Median :0.79457   Median : 0.6749   Median : 0.4815   Median :0.8436  
##  Mean   :0.83716   Mean   : 0.6806   Mean   : 0.4788   Mean   :0.8835  
##  3rd Qu.:1.08761   3rd Qu.: 0.9507   3rd Qu.: 0.6889   3rd Qu.:1.1016  
##  Max.   :1.66010   Max.   : 1.5820   Max.   : 1.2903   Max.   :1.5963  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.1888   Min.   :-0.2835   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.4542   1st Qu.: 0.1993   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.6454   Median : 0.4216   Median :7.000   Median :1  
##  Mean   : 0.6637   Mean   : 0.4505   Mean   :7.061   Mean   :1  
##  3rd Qu.: 0.8721   3rd Qu.: 0.7149   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.4495   Max.   : 1.3614   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_1c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2          
##  Min.   :201.0   M:  0   Min.   :-0.3639   Min.   :-0.43558  
##  1st Qu.:250.5   F:102   1st Qu.: 0.2264   1st Qu.: 0.07573  
##  Median :301.5           Median : 0.4729   Median : 0.32931  
##  Mean   :302.4           Mean   : 0.4998   Mean   : 0.30900  
##  3rd Qu.:352.5           3rd Qu.: 0.7807   3rd Qu.: 0.51530  
##  Max.   :399.0           Max.   : 1.3481   Max.   : 1.05111  
##        S3                 S4                S5                S6          
##  Min.   :-1.03763   Min.   :-0.2206   Min.   :-0.4092   Min.   :-0.51031  
##  1st Qu.:-0.18458   1st Qu.: 0.3172   1st Qu.: 0.1289   1st Qu.:-0.02697  
##  Median : 0.06834   Median : 0.4869   Median : 0.3276   Median : 0.21055  
##  Mean   : 0.05925   Mean   : 0.5132   Mean   : 0.3438   Mean   : 0.16546  
##  3rd Qu.: 0.27893   3rd Qu.: 0.7154   3rd Qu.: 0.5561   3rd Qu.: 0.35764  
##  Max.   : 0.86247   Max.   : 1.5386   Max.   : 1.0997   Max.   : 0.87906  
##        S7                S8                S9             symptoms   
##  Min.   :-0.3300   Min.   :-0.8261   Min.   :-0.7704   Min.   :0.00  
##  1st Qu.: 0.2215   1st Qu.: 0.1518   1st Qu.:-0.1369   1st Qu.:3.00  
##  Median : 0.4730   Median : 0.3220   Median : 0.1280   Median :4.00  
##  Mean   : 0.5034   Mean   : 0.3211   Mean   : 0.1092   Mean   :3.52  
##  3rd Qu.: 0.6946   3rd Qu.: 0.5249   3rd Qu.: 0.3609   3rd Qu.:5.00  
##  Max.   : 1.4528   Max.   : 1.0859   Max.   : 0.9743   Max.   :5.00  
##       ASD   
##  Min.   :0  
##  1st Qu.:0  
##  Median :0  
##  Mean   :0  
##  3rd Qu.:0  
##  Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 100 % males in diagnostic updating sample}
\NormalTok{results_1c <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_1c, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \DecValTok{1}\NormalTok{)}


\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_1c <-}\StringTok{ }\NormalTok{results_1c[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_1c <-}\StringTok{ }\NormalTok{results_1c[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_1c <-}\StringTok{ }\NormalTok{results_1c[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 1.c }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_1c <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_1c)}
\NormalTok{long_1c <-}\StringTok{ }\NormalTok{eval_long_1c[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_1c <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_1c)}
\NormalTok{wide_1c <-}\StringTok{ }\NormalTok{eval_wide_1c[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_1c <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_1c)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_1c <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_1c)}

\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_1c <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_1c)}



\NormalTok{### Visualizations via plots and graphs 1.c }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"TP, females"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"FN, females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"FP, females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"TN, females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"TP, males"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"FN, males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"FP, males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"TN, males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 1.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-22.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 1.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-23.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
\KeywordTok{ggplot}\NormalTok{(wide_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 1.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-24.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
\KeywordTok{ggplot}\NormalTok{(wide_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 1.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-25.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 1.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-26.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 1.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-27.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Females, simulation 1.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-28.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_1c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_1c), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 1.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-29.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_1c, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, simulation 1.c"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-30.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{############# ANALYSIS 2.a ################}

\NormalTok{### Generate data 2.a }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms}
\CommentTok{#(in this round of the simulation, correlations are different between the sexes}
\CommentTok{# there are stronger between symptoms which occur together at high frequencies}
\CommentTok{# in the different sexes, thus simulating more discrete phenotypes)}
\CommentTok{#males}
\NormalTok{SymptomCorr12_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr13_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr14_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr18_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr19_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr24_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr28_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr29_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr34_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr39_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr45_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56_m =}\StringTok{ }\FloatTok{0.04}
\NormalTok{SymptomCorr57_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr79_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr89_m =}\StringTok{ }\FloatTok{0.07}
\CommentTok{# females}
\NormalTok{SymptomCorr12_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr14_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr15_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr17_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr18_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr35_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr37_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr45_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr47_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr48_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr56_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr68_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr78_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr89_f =}\StringTok{ }\FloatTok{0.05}


\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_m, SymptomCorr13_m, SymptomCorr14_m, SymptomCorr15_m, SymptomCorr16_m, SymptomCorr17_m, SymptomCorr18_m, SymptomCorr19_m,}
\NormalTok{  SymptomCorr12_m, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_m, SymptomCorr24_m, SymptomCorr25_m, SymptomCorr26_m, SymptomCorr27_m, SymptomCorr28_m, SymptomCorr29_m,}
\NormalTok{  SymptomCorr13_m, SymptomCorr23_m, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_m, SymptomCorr35_m, SymptomCorr36_m, SymptomCorr37_m, SymptomCorr38_m, SymptomCorr39_m,}
\NormalTok{  SymptomCorr14_m, SymptomCorr24_m, SymptomCorr34_m, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_m, SymptomCorr46_m, SymptomCorr47_m, SymptomCorr48_m, SymptomCorr49_m,}
\NormalTok{  SymptomCorr15_m, SymptomCorr25_m, SymptomCorr35_m, SymptomCorr45_m, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_m, SymptomCorr57_m, SymptomCorr58_m, SymptomCorr59_m,}
\NormalTok{  SymptomCorr16_m, SymptomCorr26_m, SymptomCorr36_m, SymptomCorr46_m, SymptomCorr56_m, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_m, SymptomCorr68_m, SymptomCorr69_m,}
\NormalTok{  SymptomCorr17_m, SymptomCorr27_m, SymptomCorr37_m, SymptomCorr47_m, SymptomCorr57_m, SymptomCorr67_m, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_m, SymptomCorr79_m,}
\NormalTok{  SymptomCorr18_m, SymptomCorr28_m, SymptomCorr38_m, SymptomCorr48_m, SymptomCorr58_m, SymptomCorr68_m, SymptomCorr78_m, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_m,}
\NormalTok{  SymptomCorr19_m, SymptomCorr29_m, SymptomCorr39_m, SymptomCorr49_m, SymptomCorr59_m, SymptomCorr69_m, SymptomCorr79_m, SymptomCorr89_m, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.473822e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_f, SymptomCorr13_f, SymptomCorr14_f, SymptomCorr15_f, SymptomCorr16_f, SymptomCorr17_f, SymptomCorr18_f, SymptomCorr19_f,}
\NormalTok{  SymptomCorr12_f, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_f, SymptomCorr24_f, SymptomCorr25_f, SymptomCorr26_f, SymptomCorr27_f, SymptomCorr28_f, SymptomCorr29_f,}
\NormalTok{  SymptomCorr13_f, SymptomCorr23_f, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_f, SymptomCorr35_f, SymptomCorr36_f, SymptomCorr37_f, SymptomCorr38_f, SymptomCorr39_f,}
\NormalTok{  SymptomCorr14_f, SymptomCorr24_f, SymptomCorr34_f, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_f, SymptomCorr46_f, SymptomCorr47_f, SymptomCorr48_f, SymptomCorr49_f,}
\NormalTok{  SymptomCorr15_f, SymptomCorr25_f, SymptomCorr35_f, SymptomCorr45_f, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_f, SymptomCorr57_f, SymptomCorr58_f, SymptomCorr59_f,}
\NormalTok{  SymptomCorr16_f, SymptomCorr26_f, SymptomCorr36_f, SymptomCorr46_f, SymptomCorr56_f, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_f, SymptomCorr68_f, SymptomCorr69_f,}
\NormalTok{  SymptomCorr17_f, SymptomCorr27_f, SymptomCorr37_f, SymptomCorr47_f, SymptomCorr57_f, SymptomCorr67_f, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_f, SymptomCorr79_f,}
\NormalTok{  SymptomCorr18_f, SymptomCorr28_f, SymptomCorr38_f, SymptomCorr48_f, SymptomCorr58_f, SymptomCorr68_f, SymptomCorr78_f, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_f,}
\NormalTok{  SymptomCorr19_f, SymptomCorr29_f, SymptomCorr39_f, SymptomCorr49_f, SymptomCorr59_f, SymptomCorr69_f, SymptomCorr79_f, SymptomCorr89_f, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.402727e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_2a <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}

\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_2a[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-31.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Male[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-32.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Female[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-33.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 2.a }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_2a <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_2a)}

\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2                S3         
##  Min.   :  1.00   M:200   Min.   :-0.1855   Min.   :-0.3324   Min.   :-0.8862  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.4391   1st Qu.: 0.3750   1st Qu.: 0.3844  
##  Median :100.50           Median : 0.7529   Median : 0.6264   Median : 0.6579  
##  Mean   :100.50           Mean   : 0.7191   Mean   : 0.6601   Mean   : 0.6575  
##  3rd Qu.:150.25           3rd Qu.: 0.9973   3rd Qu.: 0.9171   3rd Qu.: 0.9580  
##  Max.   :200.00           Max.   : 1.6015   Max.   : 2.2402   Max.   : 1.6757  
##        S4                S5                S6                S7          
##  Min.   :-1.0242   Min.   :-0.6539   Min.   :-0.5191   Min.   :-0.55828  
##  1st Qu.: 0.1428   1st Qu.: 0.1950   1st Qu.: 0.2285   1st Qu.:-0.02291  
##  Median : 0.4200   Median : 0.5270   Median : 0.5192   Median : 0.27589  
##  Mean   : 0.4286   Mean   : 0.4997   Mean   : 0.5241   Mean   : 0.26015  
##  3rd Qu.: 0.6996   3rd Qu.: 0.7890   3rd Qu.: 0.8125   3rd Qu.: 0.54208  
##  Max.   : 1.6656   Max.   : 1.7746   Max.   : 1.5741   Max.   : 1.25543  
##        S8                 S9               symptoms        ASD       
##  Min.   :-0.85057   Min.   :-0.825204   Min.   :0.0   Min.   :0.000  
##  1st Qu.:-0.00793   1st Qu.:-0.004993   1st Qu.:4.0   1st Qu.:0.000  
##  Median : 0.34287   Median : 0.274815   Median :5.0   Median :0.000  
##  Mean   : 0.30130   Mean   : 0.261114   Mean   :5.2   Mean   :0.445  
##  3rd Qu.: 0.60976   3rd Qu.: 0.543036   3rd Qu.:7.0   3rd Qu.:1.000  
##  Max.   : 1.44346   Max.   : 1.303368   Max.   :9.0   Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender       S1               S2                 S3        
##  Min.   :  1.00   M:89   Min.   :0.0227   Min.   :-0.09288   Min.   :0.1103  
##  1st Qu.: 46.00   F: 0   1st Qu.:0.6798   1st Qu.: 0.58527   1st Qu.:0.4814  
##  Median : 96.00          Median :0.8338   Median : 0.80078   Median :0.7782  
##  Mean   : 94.97          Mean   :0.8807   Mean   : 0.80809   Mean   :0.7963  
##  3rd Qu.:137.00          3rd Qu.:1.1168   3rd Qu.: 1.00082   3rd Qu.:1.0460  
##  Max.   :200.00          Max.   :1.6015   Max.   : 2.24017   Max.   :1.6757  
##        S4                S5                S6                S7         
##  Min.   :-0.3181   Min.   :-0.1404   Min.   :-0.0193   Min.   :-0.2485  
##  1st Qu.: 0.4283   1st Qu.: 0.4903   1st Qu.: 0.5135   1st Qu.: 0.2499  
##  Median : 0.6671   Median : 0.7168   Median : 0.7016   Median : 0.5118  
##  Mean   : 0.6696   Mean   : 0.7240   Mean   : 0.7307   Mean   : 0.4651  
##  3rd Qu.: 0.9034   3rd Qu.: 0.9080   3rd Qu.: 0.9567   3rd Qu.: 0.6914  
##  Max.   : 1.6656   Max.   : 1.7746   Max.   : 1.5741   Max.   : 1.2554  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.5116   Min.   :-0.4543   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.3973   1st Qu.: 0.2703   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.5958   Median : 0.4939   Median :7.000   Median :1  
##  Mean   : 0.5536   Mean   : 0.4775   Mean   :7.146   Mean   :1  
##  3rd Qu.: 0.7392   3rd Qu.: 0.7041   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.4435   Max.   : 1.3034   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :  7.0   M:111   Min.   :-0.1855   Min.   :-0.3324   Min.   :-0.8862  
##  1st Qu.: 57.5   F:  0   1st Qu.: 0.3133   1st Qu.: 0.2984   1st Qu.: 0.2994  
##  Median :107.0           Median : 0.6049   Median : 0.4987   Median : 0.5736  
##  Mean   :104.9           Mean   : 0.5895   Mean   : 0.5415   Mean   : 0.5461  
##  3rd Qu.:158.5           3rd Qu.: 0.8677   3rd Qu.: 0.7995   3rd Qu.: 0.8696  
##  Max.   :198.0           Max.   : 1.2144   Max.   : 1.5924   Max.   : 1.6189  
##        S4                 S5                 S6                 S7          
##  Min.   :-1.02416   Min.   :-0.65392   Min.   :-0.51906   Min.   :-0.55828  
##  1st Qu.: 0.01295   1st Qu.: 0.02993   1st Qu.: 0.08333   1st Qu.:-0.16200  
##  Median : 0.25553   Median : 0.34093   Median : 0.32749   Median : 0.07763  
##  Mean   : 0.23538   Mean   : 0.31984   Mean   : 0.35853   Mean   : 0.09578  
##  3rd Qu.: 0.45724   3rd Qu.: 0.62538   3rd Qu.: 0.61044   3rd Qu.: 0.30460  
##  Max.   : 1.30289   Max.   : 1.13874   Max.   : 1.31674   Max.   : 0.99115  
##        S8                 S9              symptoms         ASD   
##  Min.   :-0.85057   Min.   :-0.82520   Min.   :0.00   Min.   :0  
##  1st Qu.:-0.12493   1st Qu.:-0.10403   1st Qu.:3.00   1st Qu.:0  
##  Median : 0.09141   Median : 0.09900   Median :4.00   Median :0  
##  Mean   : 0.09903   Mean   : 0.08762   Mean   :3.64   Mean   :0  
##  3rd Qu.: 0.34475   3rd Qu.: 0.30378   3rd Qu.:5.00   3rd Qu.:0  
##  Max.   : 1.01316   Max.   : 0.71662   Max.   :5.00   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3          
##  Min.   :201.0   M:  0   Min.   :-0.3322   Min.   :-0.6285   Min.   :-0.63662  
##  1st Qu.:250.8   F:200   1st Qu.: 0.4482   1st Qu.: 0.2017   1st Qu.: 0.06253  
##  Median :300.5           Median : 0.6686   Median : 0.4882   Median : 0.33213  
##  Mean   :300.5           Mean   : 0.6878   Mean   : 0.4642   Mean   : 0.32725  
##  3rd Qu.:350.2           3rd Qu.: 0.9408   3rd Qu.: 0.7518   3rd Qu.: 0.58834  
##  Max.   :400.0           Max.   : 1.6743   Max.   : 1.2869   Max.   : 1.39450  
##        S4                S5                S6                  S7         
##  Min.   :-0.6043   Min.   :-0.8015   Min.   :-0.712670   Min.   :-0.5223  
##  1st Qu.: 0.3946   1st Qu.: 0.2487   1st Qu.:-0.002888   1st Qu.: 0.3857  
##  Median : 0.7076   Median : 0.4896   Median : 0.277761   Median : 0.6579  
##  Mean   : 0.6869   Mean   : 0.5066   Mean   : 0.265468   Mean   : 0.6525  
##  3rd Qu.: 0.9613   3rd Qu.: 0.7818   3rd Qu.: 0.534106   3rd Qu.: 0.9459  
##  Max.   : 1.8718   Max.   : 1.5417   Max.   : 1.119227   Max.   : 1.6649  
##        S8                S9              symptoms          ASD       
##  Min.   :-0.8649   Min.   :-0.78691   Min.   :0.000   Min.   :0.000  
##  1st Qu.: 0.2362   1st Qu.: 0.04533   1st Qu.:4.000   1st Qu.:0.000  
##  Median : 0.5114   Median : 0.35029   Median :5.000   Median :0.000  
##  Mean   : 0.4893   Mean   : 0.31166   Mean   :5.295   Mean   :0.465  
##  3rd Qu.: 0.7438   3rd Qu.: 0.62708   3rd Qu.:7.000   3rd Qu.:1.000  
##  Max.   : 1.9382   Max.   : 1.15446   Max.   :9.000   Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1               S2                S3         
##  Min.   :203.0   M: 0   Min.   :0.1166   Min.   :-0.2959   Min.   :-0.4667  
##  1st Qu.:252.0   F:93   1st Qu.:0.6038   1st Qu.: 0.4972   1st Qu.: 0.3252  
##  Median :300.0          Median :0.8602   Median : 0.6332   Median : 0.5523  
##  Mean   :301.7          Mean   :0.8810   Mean   : 0.6770   Mean   : 0.5168  
##  3rd Qu.:348.0          3rd Qu.:1.1395   3rd Qu.: 0.8954   3rd Qu.: 0.7690  
##  Max.   :400.0          Max.   :1.6743   Max.   : 1.2497   Max.   : 1.3945  
##        S4                 S5                 S6                S7           
##  Min.   :-0.05157   Min.   :0.008692   Min.   :-0.5795   Min.   :0.0004789  
##  1st Qu.: 0.69937   1st Qu.:0.486688   1st Qu.: 0.2720   1st Qu.:0.5838266  
##  Median : 0.84320   Median :0.750726   Median : 0.4708   Median :0.9051612  
##  Mean   : 0.88512   Mean   :0.759991   Mean   : 0.4875   Mean   :0.8826667  
##  3rd Qu.: 1.18964   3rd Qu.:0.987830   3rd Qu.: 0.7091   3rd Qu.:1.0976375  
##  Max.   : 1.87181   Max.   :1.541681   Max.   : 1.1192   Max.   :1.6649210  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.3269   Min.   :-0.2190   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.5152   1st Qu.: 0.2963   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.6673   Median : 0.5651   Median :7.000   Median :1  
##  Mean   : 0.6786   Mean   : 0.5206   Mean   :7.387   Mean   :1  
##  3rd Qu.: 0.8428   3rd Qu.: 0.7330   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.9382   Max.   : 1.1545   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_2a }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                 S3         
##  Min.   :201.0   M:  0   Min.   :-0.3322   Min.   :-0.62852   Min.   :-0.6366  
##  1st Qu.:249.5   F:107   1st Qu.: 0.3105   1st Qu.: 0.02342   1st Qu.:-0.0631  
##  Median :303.0           Median : 0.5023   Median : 0.29264   Median : 0.1879  
##  Mean   :299.5           Mean   : 0.5199   Mean   : 0.27935   Mean   : 0.1625  
##  3rd Qu.:352.5           3rd Qu.: 0.7752   3rd Qu.: 0.55266   3rd Qu.: 0.3529  
##  Max.   :399.0           Max.   : 1.4596   Max.   : 1.28689   Max.   : 0.9994  
##        S4                S5                 S6                 S7         
##  Min.   :-0.6043   Min.   :-0.80151   Min.   :-0.71267   Min.   :-0.5223  
##  1st Qu.: 0.2753   1st Qu.: 0.06869   1st Qu.:-0.16051   1st Qu.: 0.2003  
##  Median : 0.4946   Median : 0.28211   Median : 0.07294   Median : 0.4911  
##  Mean   : 0.5145   Mean   : 0.28628   Mean   : 0.07247   Mean   : 0.4525  
##  3rd Qu.: 0.7309   3rd Qu.: 0.54666   3rd Qu.: 0.31929   3rd Qu.: 0.6992  
##  Max.   : 1.7167   Max.   : 1.00707   Max.   : 0.90233   Max.   : 1.5380  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.8649   Min.   :-0.7869   Min.   :0.000   Min.   :0  
##  1st Qu.: 0.1224   1st Qu.:-0.1187   1st Qu.:2.500   1st Qu.:0  
##  Median : 0.3172   Median : 0.1873   Median :4.000   Median :0  
##  Mean   : 0.3249   Mean   : 0.1301   Mean   :3.477   Mean   :0  
##  3rd Qu.: 0.5564   3rd Qu.: 0.3885   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.2264   Max.   : 1.0955   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 50 % males in diagnostic updating sample}
\NormalTok{results_2a <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_2a, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \FloatTok{0.5}\NormalTok{)}


\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_2a <-}\StringTok{ }\NormalTok{results_2a[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_2a <-}\StringTok{ }\NormalTok{results_2a[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_2a <-}\StringTok{ }\NormalTok{results_2a[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 2.a }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_2a <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_2a)}
\NormalTok{long_2a <-}\StringTok{ }\NormalTok{eval_long_2a[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_2a <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_2a)}
\NormalTok{wide_2a <-}\StringTok{ }\NormalTok{eval_wide_2a[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_2a <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_2a)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_2a <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_2a)}


\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_2a <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_2a)}



\NormalTok{### Visualizations via plots and graphs 2.a }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 2.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-34.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 2.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-35.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
\KeywordTok{ggplot}\NormalTok{(wide_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 2.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-36.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
\KeywordTok{ggplot}\NormalTok{(wide_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 2.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-37.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 2.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-38.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 2.a"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-39.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Females, simulation 2.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-40.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2a, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2a), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 2.a"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-41.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_2a, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, simulation 2.a"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-42.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{############# ANALYSIS 2.b ################}

\NormalTok{### Generate data 2.b }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms}
\CommentTok{#(in this round of the simulation, correlations are different between the sexes}
\CommentTok{# there are stronger between symptoms which occur together at high frequencies}
\CommentTok{# in the different sexes, thus simulating more discrete phenotypes)}
\CommentTok{#males}
\NormalTok{SymptomCorr12_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr13_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr14_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr18_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr19_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr24_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr28_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr29_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr34_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr39_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr45_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56_m =}\StringTok{ }\FloatTok{0.04}
\NormalTok{SymptomCorr57_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr79_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr89_m =}\StringTok{ }\FloatTok{0.07}
\CommentTok{# females}
\NormalTok{SymptomCorr12_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr14_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr15_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr17_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr18_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr35_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr37_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr45_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr47_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr48_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr56_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr68_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr78_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr89_f =}\StringTok{ }\FloatTok{0.05}


\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_m, SymptomCorr13_m, SymptomCorr14_m, SymptomCorr15_m, SymptomCorr16_m, SymptomCorr17_m, SymptomCorr18_m, SymptomCorr19_m,}
\NormalTok{  SymptomCorr12_m, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_m, SymptomCorr24_m, SymptomCorr25_m, SymptomCorr26_m, SymptomCorr27_m, SymptomCorr28_m, SymptomCorr29_m,}
\NormalTok{  SymptomCorr13_m, SymptomCorr23_m, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_m, SymptomCorr35_m, SymptomCorr36_m, SymptomCorr37_m, SymptomCorr38_m, SymptomCorr39_m,}
\NormalTok{  SymptomCorr14_m, SymptomCorr24_m, SymptomCorr34_m, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_m, SymptomCorr46_m, SymptomCorr47_m, SymptomCorr48_m, SymptomCorr49_m,}
\NormalTok{  SymptomCorr15_m, SymptomCorr25_m, SymptomCorr35_m, SymptomCorr45_m, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_m, SymptomCorr57_m, SymptomCorr58_m, SymptomCorr59_m,}
\NormalTok{  SymptomCorr16_m, SymptomCorr26_m, SymptomCorr36_m, SymptomCorr46_m, SymptomCorr56_m, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_m, SymptomCorr68_m, SymptomCorr69_m,}
\NormalTok{  SymptomCorr17_m, SymptomCorr27_m, SymptomCorr37_m, SymptomCorr47_m, SymptomCorr57_m, SymptomCorr67_m, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_m, SymptomCorr79_m,}
\NormalTok{  SymptomCorr18_m, SymptomCorr28_m, SymptomCorr38_m, SymptomCorr48_m, SymptomCorr58_m, SymptomCorr68_m, SymptomCorr78_m, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_m,}
\NormalTok{  SymptomCorr19_m, SymptomCorr29_m, SymptomCorr39_m, SymptomCorr49_m, SymptomCorr59_m, SymptomCorr69_m, SymptomCorr79_m, SymptomCorr89_m, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.473822e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_f, SymptomCorr13_f, SymptomCorr14_f, SymptomCorr15_f, SymptomCorr16_f, SymptomCorr17_f, SymptomCorr18_f, SymptomCorr19_f,}
\NormalTok{  SymptomCorr12_f, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_f, SymptomCorr24_f, SymptomCorr25_f, SymptomCorr26_f, SymptomCorr27_f, SymptomCorr28_f, SymptomCorr29_f,}
\NormalTok{  SymptomCorr13_f, SymptomCorr23_f, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_f, SymptomCorr35_f, SymptomCorr36_f, SymptomCorr37_f, SymptomCorr38_f, SymptomCorr39_f,}
\NormalTok{  SymptomCorr14_f, SymptomCorr24_f, SymptomCorr34_f, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_f, SymptomCorr46_f, SymptomCorr47_f, SymptomCorr48_f, SymptomCorr49_f,}
\NormalTok{  SymptomCorr15_f, SymptomCorr25_f, SymptomCorr35_f, SymptomCorr45_f, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_f, SymptomCorr57_f, SymptomCorr58_f, SymptomCorr59_f,}
\NormalTok{  SymptomCorr16_f, SymptomCorr26_f, SymptomCorr36_f, SymptomCorr46_f, SymptomCorr56_f, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_f, SymptomCorr68_f, SymptomCorr69_f,}
\NormalTok{  SymptomCorr17_f, SymptomCorr27_f, SymptomCorr37_f, SymptomCorr47_f, SymptomCorr57_f, SymptomCorr67_f, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_f, SymptomCorr79_f,}
\NormalTok{  SymptomCorr18_f, SymptomCorr28_f, SymptomCorr38_f, SymptomCorr48_f, SymptomCorr58_f, SymptomCorr68_f, SymptomCorr78_f, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_f,}
\NormalTok{  SymptomCorr19_f, SymptomCorr29_f, SymptomCorr39_f, SymptomCorr49_f, SymptomCorr59_f, SymptomCorr69_f, SymptomCorr79_f, SymptomCorr89_f, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.402727e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_2b <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}

\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_2b[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-43.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Male[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-44.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Female[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-45.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 2.b }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_2b <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_2b)}

\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2                S3         
##  Min.   :  1.00   M:200   Min.   :-0.6020   Min.   :-0.4540   Min.   :-0.4629  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.3990   1st Qu.: 0.3860   1st Qu.: 0.4408  
##  Median :100.50           Median : 0.6894   Median : 0.6859   Median : 0.7263  
##  Mean   :100.50           Mean   : 0.6882   Mean   : 0.6822   Mean   : 0.7201  
##  3rd Qu.:150.25           3rd Qu.: 0.9824   3rd Qu.: 0.9375   3rd Qu.: 1.0177  
##  Max.   :200.00           Max.   : 1.7690   Max.   : 1.8099   Max.   : 1.7591  
##        S4                S5                S6                S7          
##  Min.   :-0.5178   Min.   :-0.5277   Min.   :-0.9186   Min.   :-0.84119  
##  1st Qu.: 0.2656   1st Qu.: 0.2070   1st Qu.: 0.2348   1st Qu.:-0.04371  
##  Median : 0.4890   Median : 0.4708   Median : 0.4871   Median : 0.23371  
##  Mean   : 0.4749   Mean   : 0.4743   Mean   : 0.4944   Mean   : 0.24093  
##  3rd Qu.: 0.7181   3rd Qu.: 0.7076   3rd Qu.: 0.7448   3rd Qu.: 0.48515  
##  Max.   : 1.5293   Max.   : 1.8780   Max.   : 1.7384   Max.   : 1.36337  
##        S8                  S9              symptoms         ASD       
##  Min.   :-0.994862   Min.   :-0.72876   Min.   :0.00   Min.   :0.000  
##  1st Qu.:-0.002345   1st Qu.:-0.02863   1st Qu.:4.00   1st Qu.:0.000  
##  Median : 0.230911   Median : 0.26471   Median :5.00   Median :0.000  
##  Mean   : 0.259220   Mean   : 0.24821   Mean   :5.09   Mean   :0.435  
##  3rd Qu.: 0.550973   3rd Qu.: 0.53463   3rd Qu.:7.00   3rd Qu.:1.000  
##  Max.   : 1.224968   Max.   : 1.12321   Max.   :9.00   Max.   :1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender       S1                S2                 S3        
##  Min.   :  3.00   M:87   Min.   :-0.1269   Min.   :0.005773   Min.   :0.1750  
##  1st Qu.: 47.50   F: 0   1st Qu.: 0.5944   1st Qu.:0.655269   1st Qu.:0.6236  
##  Median : 98.00          Median : 0.8683   Median :0.849725   Median :0.8364  
##  Mean   : 99.09          Mean   : 0.8615   Mean   :0.870252   Mean   :0.8481  
##  3rd Qu.:143.00          3rd Qu.: 1.1116   3rd Qu.:1.083743   3rd Qu.:1.0952  
##  Max.   :199.00          Max.   : 1.7690   Max.   :1.523674   Max.   :1.7591  
##        S4                S5                S6                S7         
##  Min.   :-0.1066   Min.   :-0.2770   Min.   :-0.2534   Min.   :-0.5654  
##  1st Qu.: 0.4519   1st Qu.: 0.4936   1st Qu.: 0.4926   1st Qu.: 0.2435  
##  Median : 0.6487   Median : 0.6674   Median : 0.6857   Median : 0.4674  
##  Mean   : 0.6458   Mean   : 0.7161   Mean   : 0.7263   Mean   : 0.4559  
##  3rd Qu.: 0.7868   3rd Qu.: 0.9519   3rd Qu.: 0.9670   3rd Qu.: 0.7124  
##  Max.   : 1.4920   Max.   : 1.8780   Max.   : 1.7384   Max.   : 1.3634  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.5438   Min.   :-0.4591   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.2007   1st Qu.: 0.2143   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.5506   Median : 0.4847   Median :7.000   Median :1  
##  Mean   : 0.4956   Mean   : 0.4759   Mean   :7.172   Mean   :1  
##  3rd Qu.: 0.8057   3rd Qu.: 0.8017   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.2250   Max.   : 1.1232   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :  1.0   M:113   Min.   :-0.6020   Min.   :-0.4540   Min.   :-0.4629  
##  1st Qu.: 52.0   F:  0   1st Qu.: 0.3167   1st Qu.: 0.3078   1st Qu.: 0.3412  
##  Median :102.0           Median : 0.5443   Median : 0.5277   Median : 0.5811  
##  Mean   :101.6           Mean   : 0.5548   Mean   : 0.5373   Mean   : 0.6215  
##  3rd Qu.:155.0           3rd Qu.: 0.8216   3rd Qu.: 0.7881   3rd Qu.: 0.9066  
##  Max.   :200.0           Max.   : 1.5679   Max.   : 1.8099   Max.   : 1.5832  
##        S4                S5                 S6                 S7          
##  Min.   :-0.5178   Min.   :-0.52771   Min.   :-0.91859   Min.   :-0.84119  
##  1st Qu.: 0.1375   1st Qu.: 0.05731   1st Qu.: 0.09173   1st Qu.:-0.10237  
##  Median : 0.3171   Median : 0.30507   Median : 0.30319   Median : 0.08116  
##  Mean   : 0.3433   Mean   : 0.28815   Mean   : 0.31586   Mean   : 0.07545  
##  3rd Qu.: 0.5571   3rd Qu.: 0.49795   3rd Qu.: 0.57724   3rd Qu.: 0.25491  
##  Max.   : 1.5293   Max.   : 1.40414   Max.   : 1.29170   Max.   : 0.76604  
##        S8                 S9              symptoms          ASD   
##  Min.   :-0.99486   Min.   :-0.72876   Min.   :0.000   Min.   :0  
##  1st Qu.:-0.16009   1st Qu.:-0.17072   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.07241   Median : 0.05265   Median :4.000   Median :0  
##  Mean   : 0.07723   Mean   : 0.07291   Mean   :3.487   Mean   :0  
##  3rd Qu.: 0.30020   3rd Qu.: 0.36066   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.06873   Max.   : 0.87559   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3          
##  Min.   :201.0   M:  0   Min.   :-0.5510   Min.   :-0.5990   Min.   :-0.89375  
##  1st Qu.:250.8   F:200   1st Qu.: 0.4421   1st Qu.: 0.2578   1st Qu.: 0.06452  
##  Median :300.5           Median : 0.7482   Median : 0.4998   Median : 0.31253  
##  Mean   :300.5           Mean   : 0.7435   Mean   : 0.4985   Mean   : 0.30283  
##  3rd Qu.:350.2           3rd Qu.: 1.0221   3rd Qu.: 0.7476   3rd Qu.: 0.55066  
##  Max.   :400.0           Max.   : 1.9752   Max.   : 1.6774   Max.   : 1.62174  
##        S4                S5                S6                 S7         
##  Min.   :-0.4309   Min.   :-0.5006   Min.   :-0.69548   Min.   :-0.2306  
##  1st Qu.: 0.4667   1st Qu.: 0.2622   1st Qu.: 0.01389   1st Qu.: 0.4468  
##  Median : 0.6725   Median : 0.5503   Median : 0.31626   Median : 0.6908  
##  Mean   : 0.7086   Mean   : 0.5077   Mean   : 0.31020   Mean   : 0.7024  
##  3rd Qu.: 0.9382   3rd Qu.: 0.7572   3rd Qu.: 0.59450   3rd Qu.: 0.9365  
##  Max.   : 2.0138   Max.   : 1.7820   Max.   : 1.27413   Max.   : 2.0618  
##        S8                S9              symptoms          ASD      
##  Min.   :-0.6427   Min.   :-0.93459   Min.   :0.000   Min.   :0.00  
##  1st Qu.: 0.2206   1st Qu.: 0.03154   1st Qu.:4.000   1st Qu.:0.00  
##  Median : 0.5006   Median : 0.30003   Median :6.000   Median :1.00  
##  Mean   : 0.4837   Mean   : 0.30252   Mean   :5.385   Mean   :0.52  
##  3rd Qu.: 0.7726   3rd Qu.: 0.58441   3rd Qu.:7.000   3rd Qu.:1.00  
##  Max.   : 1.5422   Max.   : 1.27222   Max.   :9.000   Max.   :1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :203.0   M:  0   Min.   :0.08285   Min.   :-0.2140   Min.   :-0.4347  
##  1st Qu.:247.8   F:104   1st Qu.:0.70144   1st Qu.: 0.5164   1st Qu.: 0.3077  
##  Median :290.5           Median :0.94732   Median : 0.6803   Median : 0.4965  
##  Mean   :293.6           Mean   :0.92897   Mean   : 0.7091   Mean   : 0.5322  
##  3rd Qu.:338.8           3rd Qu.:1.17294   3rd Qu.: 0.8773   3rd Qu.: 0.7087  
##  Max.   :398.0           Max.   :1.97525   Max.   : 1.6774   Max.   : 1.6217  
##        S4               S5                S6                S7           
##  Min.   :0.3114   Min.   :-0.2148   Min.   :-0.2865   Min.   :-0.001563  
##  1st Qu.:0.6129   1st Qu.: 0.4638   1st Qu.: 0.2976   1st Qu.: 0.623399  
##  Median :0.8047   Median : 0.6044   Median : 0.5382   Median : 0.893382  
##  Mean   :0.8772   Mean   : 0.6414   Mean   : 0.5152   Mean   : 0.901502  
##  3rd Qu.:1.0944   3rd Qu.: 0.8242   3rd Qu.: 0.7422   3rd Qu.: 1.081524  
##  Max.   :2.0138   Max.   : 1.7820   Max.   : 1.2741   Max.   : 2.061838  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.3278   Min.   :-0.4845   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.4967   1st Qu.: 0.2360   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.6846   Median : 0.5163   Median :7.000   Median :1  
##  Mean   : 0.6799   Mean   : 0.4937   Mean   :7.231   Mean   :1  
##  3rd Qu.: 0.9185   3rd Qu.: 0.7246   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.5422   Max.   : 1.2722   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_2b }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1                S2                 S3          
##  Min.   :201.0   M: 0   Min.   :-0.5510   Min.   :-0.59904   Min.   :-0.89375  
##  1st Qu.:260.2   F:96   1st Qu.: 0.2995   1st Qu.: 0.04281   1st Qu.:-0.15777  
##  Median :311.0          Median : 0.5217   Median : 0.28916   Median : 0.08754  
##  Mean   :307.9          Mean   : 0.5426   Mean   : 0.27045   Mean   : 0.05436  
##  3rd Qu.:361.2          3rd Qu.: 0.7621   3rd Qu.: 0.48147   3rd Qu.: 0.30372  
##  Max.   :400.0          Max.   : 1.6297   Max.   : 1.23621   Max.   : 0.88078  
##        S4                S5                S6                 S7         
##  Min.   :-0.4309   Min.   :-0.5006   Min.   :-0.69548   Min.   :-0.2306  
##  1st Qu.: 0.2778   1st Qu.: 0.1260   1st Qu.:-0.14343   1st Qu.: 0.2293  
##  Median : 0.5049   Median : 0.3500   Median : 0.11510   Median : 0.4883  
##  Mean   : 0.5260   Mean   : 0.3627   Mean   : 0.08807   Mean   : 0.4867  
##  3rd Qu.: 0.7542   3rd Qu.: 0.6282   3rd Qu.: 0.31404   3rd Qu.: 0.7258  
##  Max.   : 1.2766   Max.   : 1.2261   Max.   : 1.05286   Max.   : 1.5581  
##        S8                 S9              symptoms          ASD   
##  Min.   :-0.64268   Min.   :-0.93459   Min.   :0.000   Min.   :0  
##  1st Qu.: 0.06215   1st Qu.:-0.10612   1st Qu.:2.000   1st Qu.:0  
##  Median : 0.27424   Median : 0.07667   Median :4.000   Median :0  
##  Mean   : 0.27110   Mean   : 0.09540   Mean   :3.385   Mean   :0  
##  3rd Qu.: 0.49517   3rd Qu.: 0.30448   3rd Qu.:4.250   3rd Qu.:0  
##  Max.   : 0.90276   Max.   : 1.03204   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 80 % males in diagnostic updating sample}
\NormalTok{results_2b <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_2b, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \FloatTok{0.8}\NormalTok{)}


\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_2b <-}\StringTok{ }\NormalTok{results_2b[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_2b <-}\StringTok{ }\NormalTok{results_2b[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_2b <-}\StringTok{ }\NormalTok{results_2b[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 2.b }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_2b <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_2b)}
\NormalTok{long_2b <-}\StringTok{ }\NormalTok{eval_long_2b[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_2b <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_2b)}
\NormalTok{wide_2b <-}\StringTok{ }\NormalTok{eval_wide_2b[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_2b <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_2b)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_2b <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_2b)}


\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_2b <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_2b)}



\NormalTok{### Visualizations via plots and graphs 2.b }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 2.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-46.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 2.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-47.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
\KeywordTok{ggplot}\NormalTok{(wide_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 2.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-48.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
\KeywordTok{ggplot}\NormalTok{(wide_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 2.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-49.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 2.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-50.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 2.b"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-51.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Females, simulation 2.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-52.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2b, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2b), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 2.b"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-53.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_2b, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, simulation 2.b"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-54.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{############# ANALYSIS 2.c ################}

\NormalTok{### Generate data 2.c }\AlertTok{###}

\CommentTok{# set a mean and sd for the severity of 9 symptoms in males and females}
\CommentTok{# males}
\NormalTok{Symptom1_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom2_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Male_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom3_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom4_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Male_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom6_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom7_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom8_Male_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Male_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Male_SD =}\StringTok{ }\FloatTok{0.4}
\CommentTok{# females}
\NormalTok{Symptom1_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom1_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom2_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom2_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom3_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom3_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom4_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom4_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom5_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom5_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom6_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom6_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom7_Female_M =}\StringTok{ }\FloatTok{0.7}
\NormalTok{Symptom7_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom8_Female_M =}\StringTok{ }\FloatTok{0.5}
\NormalTok{Symptom8_Female_SD =}\StringTok{ }\FloatTok{0.4}
\NormalTok{Symptom9_Female_M =}\StringTok{ }\FloatTok{0.3}
\NormalTok{Symptom9_Female_SD =}\StringTok{ }\FloatTok{0.4}

\CommentTok{# Set correlations between symptoms}
\CommentTok{#(in this round of the simulation, correlations are different between the sexes}
\CommentTok{# there are stronger between symptoms which occur together at high frequencies}
\CommentTok{# in the different sexes, thus simulating more discrete phenotypes)}
\CommentTok{#males}
\NormalTok{SymptomCorr12_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr13_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr14_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr15_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr17_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr18_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr19_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr24_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr28_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr29_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr34_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr35_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr37_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr39_m =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr45_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr47_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr48_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr56_m =}\StringTok{ }\FloatTok{0.04}
\NormalTok{SymptomCorr57_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr68_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_m =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr78_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr79_m =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr89_m =}\StringTok{ }\FloatTok{0.07}
\CommentTok{# females}
\NormalTok{SymptomCorr12_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr13_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr14_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr15_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr16_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr17_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr18_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr19_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr23_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr24_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr25_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr26_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr27_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr28_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr29_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr34_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr35_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr36_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr37_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr38_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr39_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr45_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr46_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr47_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr48_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr49_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr56_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr57_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr58_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr59_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr67_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr68_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr69_f =}\StringTok{ }\FloatTok{0.07}
\NormalTok{SymptomCorr78_f =}\StringTok{ }\FloatTok{0.05}
\NormalTok{SymptomCorr79_f =}\StringTok{ }\FloatTok{0.03}
\NormalTok{SymptomCorr89_f =}\StringTok{ }\FloatTok{0.05}


\CommentTok{# Geneate male agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaMale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_m, SymptomCorr13_m, SymptomCorr14_m, SymptomCorr15_m, SymptomCorr16_m, SymptomCorr17_m, SymptomCorr18_m, SymptomCorr19_m,}
\NormalTok{  SymptomCorr12_m, Symptom2_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_m, SymptomCorr24_m, SymptomCorr25_m, SymptomCorr26_m, SymptomCorr27_m, SymptomCorr28_m, SymptomCorr29_m,}
\NormalTok{  SymptomCorr13_m, SymptomCorr23_m, Symptom3_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_m, SymptomCorr35_m, SymptomCorr36_m, SymptomCorr37_m, SymptomCorr38_m, SymptomCorr39_m,}
\NormalTok{  SymptomCorr14_m, SymptomCorr24_m, SymptomCorr34_m, Symptom4_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_m, SymptomCorr46_m, SymptomCorr47_m, SymptomCorr48_m, SymptomCorr49_m,}
\NormalTok{  SymptomCorr15_m, SymptomCorr25_m, SymptomCorr35_m, SymptomCorr45_m, Symptom5_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_m, SymptomCorr57_m, SymptomCorr58_m, SymptomCorr59_m,}
\NormalTok{  SymptomCorr16_m, SymptomCorr26_m, SymptomCorr36_m, SymptomCorr46_m, SymptomCorr56_m, Symptom6_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_m, SymptomCorr68_m, SymptomCorr69_m,}
\NormalTok{  SymptomCorr17_m, SymptomCorr27_m, SymptomCorr37_m, SymptomCorr47_m, SymptomCorr57_m, SymptomCorr67_m, Symptom7_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_m, SymptomCorr79_m,}
\NormalTok{  SymptomCorr18_m, SymptomCorr28_m, SymptomCorr38_m, SymptomCorr48_m, SymptomCorr58_m, SymptomCorr68_m, SymptomCorr78_m, Symptom8_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_m,}
\NormalTok{  SymptomCorr19_m, SymptomCorr29_m, SymptomCorr39_m, SymptomCorr49_m, SymptomCorr59_m, SymptomCorr69_m, SymptomCorr79_m, SymptomCorr89_m, Symptom9_Male_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# Test for positive definitive}
\KeywordTok{det}\NormalTok{(SigmaMale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.473822e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of male participant}
                  \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Male_M, Symptom2_Male_M, Symptom3_Male_M, Symptom4_Male_M, Symptom5_Male_M, Symptom6_Male_M, Symptom7_Male_M, Symptom8_Male_M, Symptom9_Male_M), }\CommentTok{# mean of each variable}
\NormalTok{                  SigmaMale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Male <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Male)),}
  \DataTypeTok{gender =} \StringTok{"M"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Male [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Male [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Male [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Male [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Male [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Male [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Male [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Male [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Male [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Generate female agents}
\CommentTok{# Create a variance-covariance matrix for the symptom severities we want to generate (variance is sd^2)}
\NormalTok{SigmaFemale <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data=}\KeywordTok{c}\NormalTok{(}
\NormalTok{  Symptom1_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr12_f, SymptomCorr13_f, SymptomCorr14_f, SymptomCorr15_f, SymptomCorr16_f, SymptomCorr17_f, SymptomCorr18_f, SymptomCorr19_f,}
\NormalTok{  SymptomCorr12_f, Symptom2_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr23_f, SymptomCorr24_f, SymptomCorr25_f, SymptomCorr26_f, SymptomCorr27_f, SymptomCorr28_f, SymptomCorr29_f,}
\NormalTok{  SymptomCorr13_f, SymptomCorr23_f, Symptom3_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr34_f, SymptomCorr35_f, SymptomCorr36_f, SymptomCorr37_f, SymptomCorr38_f, SymptomCorr39_f,}
\NormalTok{  SymptomCorr14_f, SymptomCorr24_f, SymptomCorr34_f, Symptom4_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr45_f, SymptomCorr46_f, SymptomCorr47_f, SymptomCorr48_f, SymptomCorr49_f,}
\NormalTok{  SymptomCorr15_f, SymptomCorr25_f, SymptomCorr35_f, SymptomCorr45_f, Symptom5_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr56_f, SymptomCorr57_f, SymptomCorr58_f, SymptomCorr59_f,}
\NormalTok{  SymptomCorr16_f, SymptomCorr26_f, SymptomCorr36_f, SymptomCorr46_f, SymptomCorr56_f, Symptom6_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr67_f, SymptomCorr68_f, SymptomCorr69_f,}
\NormalTok{  SymptomCorr17_f, SymptomCorr27_f, SymptomCorr37_f, SymptomCorr47_f, SymptomCorr57_f, SymptomCorr67_f, Symptom7_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr78_f, SymptomCorr79_f,}
\NormalTok{  SymptomCorr18_f, SymptomCorr28_f, SymptomCorr38_f, SymptomCorr48_f, SymptomCorr58_f, SymptomCorr68_f, SymptomCorr78_f, Symptom8_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{, SymptomCorr89_f,}
\NormalTok{  SymptomCorr19_f, SymptomCorr29_f, SymptomCorr39_f, SymptomCorr49_f, SymptomCorr59_f, SymptomCorr69_f, SymptomCorr79_f, SymptomCorr89_f, Symptom9_Female_SD}\OperatorTok{^}\DecValTok{2}\NormalTok{),     }
  \DataTypeTok{nrow=}\DecValTok{9}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{9}\NormalTok{)}

\CommentTok{# check for positive defnitive}
\KeywordTok{det}\NormalTok{(SigmaFemale)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.402727e-09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Generate individual symptom severities for200 agents from a multivariate normal distribution}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{mvrnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{200}\NormalTok{, }\CommentTok{# number of female participant}
                    \DataTypeTok{mu =} \KeywordTok{c}\NormalTok{(Symptom1_Female_M, Symptom2_Female_M, Symptom3_Female_M, Symptom4_Female_M, Symptom5_Female_M, Symptom6_Female_M, Symptom7_Female_M, Symptom8_Female_M, Symptom9_Female_M), }\CommentTok{# mean of each variable}
\NormalTok{                    SigmaFemale) }\CommentTok{# variance co-variance matrix}

\CommentTok{# Assign new, meaningful names to variables and add ID to data frame}
\NormalTok{D_Female <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}
  \DataTypeTok{agentID =} \KeywordTok{nrow}\NormalTok{(D_Male) }\OperatorTok{+}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(D_Female)),}
  \DataTypeTok{gender =} \StringTok{"F"}\NormalTok{,}
  \DataTypeTok{S1 =}\NormalTok{ D_Female [,}\DecValTok{1}\NormalTok{],}
  \DataTypeTok{S2 =}\NormalTok{  D_Female [,}\DecValTok{2}\NormalTok{],}
  \DataTypeTok{S3 =}\NormalTok{  D_Female [,}\DecValTok{3}\NormalTok{],}
  \DataTypeTok{S4 =}\NormalTok{ D_Female [,}\DecValTok{4}\NormalTok{],}
  \DataTypeTok{S5 =}\NormalTok{ D_Female [,}\DecValTok{5}\NormalTok{],}
  \DataTypeTok{S6 =}\NormalTok{  D_Female [,}\DecValTok{6}\NormalTok{],}
  \DataTypeTok{S7 =}\NormalTok{  D_Female [,}\DecValTok{7}\NormalTok{],}
  \DataTypeTok{S8 =}\NormalTok{ D_Female [,}\DecValTok{8}\NormalTok{],}
  \DataTypeTok{S9 =}\NormalTok{ D_Female [,}\DecValTok{9}\NormalTok{]}
\NormalTok{)}


\CommentTok{# Merge the male and female dataframes into final dataframe with all agents}
\NormalTok{D_2c <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(D_Male, D_Female)}

\CommentTok{# check symptom correlation visually}
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_2c[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-55.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Male[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-56.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{heatmap}\NormalTok{(}\KeywordTok{cor}\NormalTok{(D_Female[, }\DecValTok{3}\OperatorTok{:}\DecValTok{11}\NormalTok{]), }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{viridis}\NormalTok{(}\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-57.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{### Run simulation 2.c }\AlertTok{###}

\CommentTok{# assign ASD to affected agents}
\NormalTok{D_2c <-}\StringTok{ }\KeywordTok{assign_ASD}\NormalTok{(D_2c)}

\CommentTok{# check the distribution of ASD positive diagnoses as well as symptom severities for both genders}
\CommentTok{#males}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender        S1                S2                S3         
##  Min.   :  1.00   M:200   Min.   :-0.8234   Min.   :-0.5205   Min.   :-0.6089  
##  1st Qu.: 50.75   F:  0   1st Qu.: 0.4666   1st Qu.: 0.4115   1st Qu.: 0.4445  
##  Median :100.50           Median : 0.6916   Median : 0.6840   Median : 0.6657  
##  Mean   :100.50           Mean   : 0.7015   Mean   : 0.6836   Mean   : 0.6854  
##  3rd Qu.:150.25           3rd Qu.: 0.9695   3rd Qu.: 0.9455   3rd Qu.: 0.9416  
##  Max.   :200.00           Max.   : 1.5943   Max.   : 1.7232   Max.   : 1.8104  
##        S4                S5                S6                S7           
##  Min.   :-0.7118   Min.   :-0.6043   Min.   :-0.8123   Min.   :-0.539942  
##  1st Qu.: 0.2461   1st Qu.: 0.2006   1st Qu.: 0.1964   1st Qu.:-0.002388  
##  Median : 0.4684   Median : 0.4921   Median : 0.4779   Median : 0.260249  
##  Mean   : 0.4950   Mean   : 0.4975   Mean   : 0.4601   Mean   : 0.285705  
##  3rd Qu.: 0.7675   3rd Qu.: 0.7879   3rd Qu.: 0.7386   3rd Qu.: 0.518786  
##  Max.   : 1.6798   Max.   : 1.4885   Max.   : 1.6914   Max.   : 1.501624  
##        S8                S9              symptoms          ASD      
##  Min.   :-0.7289   Min.   :-0.74314   Min.   :0.000   Min.   :0.00  
##  1st Qu.:-0.0230   1st Qu.:-0.04951   1st Qu.:4.000   1st Qu.:0.00  
##  Median : 0.2399   Median : 0.20133   Median :5.000   Median :0.00  
##  Mean   : 0.2563   Mean   : 0.22282   Mean   :5.125   Mean   :0.43  
##  3rd Qu.: 0.5489   3rd Qu.: 0.47418   3rd Qu.:7.000   3rd Qu.:1.00  
##  Max.   : 1.2021   Max.   : 1.32130   Max.   :9.000   Max.   :1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD males}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID       gender       S1               S2               S3         
##  Min.   :  2.00   M:86   Min.   :0.1618   Min.   :0.1225   Min.   :0.03841  
##  1st Qu.: 59.25   F: 0   1st Qu.:0.6007   1st Qu.:0.5780   1st Qu.:0.63220  
##  Median : 98.00          Median :0.8494   Median :0.8424   Median :0.82483  
##  Mean   :100.15          Mean   :0.8218   Mean   :0.8374   Mean   :0.86063  
##  3rd Qu.:149.00          3rd Qu.:1.0298   3rd Qu.:1.1084   3rd Qu.:1.08774  
##  Max.   :198.00          Max.   :1.5864   Max.   :1.7232   Max.   :1.81038  
##        S4                S5                 S6                S7         
##  Min.   :-0.1055   Min.   :-0.07064   Min.   :-0.7077   Min.   :-0.3139  
##  1st Qu.: 0.4713   1st Qu.: 0.49757   1st Qu.: 0.4713   1st Qu.: 0.3318  
##  Median : 0.6742   Median : 0.73333   Median : 0.6603   Median : 0.4827  
##  Mean   : 0.7086   Mean   : 0.72980   Mean   : 0.6740   Mean   : 0.5355  
##  3rd Qu.: 0.9320   3rd Qu.: 0.97516   3rd Qu.: 0.9408   3rd Qu.: 0.7750  
##  Max.   : 1.6798   Max.   : 1.48852   Max.   : 1.6914   Max.   : 1.5016  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.5230   Min.   :-0.2012   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.2512   1st Qu.: 0.2213   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.5392   Median : 0.4672   Median :7.000   Median :1  
##  Mean   : 0.4993   Mean   : 0.4909   Mean   :7.163   Mean   :1  
##  3rd Qu.: 0.7828   3rd Qu.: 0.7042   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.2021   Max.   : 1.3213   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# male controls}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "M"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3         
##  Min.   :  1.0   M:114   Min.   :-0.8234   Min.   :-0.5205   Min.   :-0.6089  
##  1st Qu.: 46.5   F:  0   1st Qu.: 0.3494   1st Qu.: 0.3253   1st Qu.: 0.3234  
##  Median :104.0           Median : 0.6384   Median : 0.5907   Median : 0.5454  
##  Mean   :100.8           Mean   : 0.6108   Mean   : 0.5675   Mean   : 0.5532  
##  3rd Qu.:150.5           3rd Qu.: 0.8777   3rd Qu.: 0.8187   3rd Qu.: 0.7969  
##  Max.   :200.0           Max.   : 1.5943   Max.   : 1.4945   Max.   : 1.6841  
##        S4                 S5                 S6                 S7          
##  Min.   :-0.71176   Min.   :-0.60431   Min.   :-0.81235   Min.   :-0.53994  
##  1st Qu.: 0.07876   1st Qu.: 0.08113   1st Qu.: 0.08163   1st Qu.:-0.10549  
##  Median : 0.31582   Median : 0.29126   Median : 0.28600   Median : 0.11348  
##  Mean   : 0.33377   Mean   : 0.32226   Mean   : 0.29871   Mean   : 0.09728  
##  3rd Qu.: 0.53325   3rd Qu.: 0.59277   3rd Qu.: 0.53788   3rd Qu.: 0.28533  
##  Max.   : 1.24380   Max.   : 1.24718   Max.   : 1.22246   Max.   : 1.12989  
##        S8                 S9              symptoms          ASD   
##  Min.   :-0.72889   Min.   :-0.74314   Min.   :0.000   Min.   :0  
##  1st Qu.:-0.16273   1st Qu.:-0.18807   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.06788   Median : 0.02011   Median :4.000   Median :0  
##  Mean   : 0.07295   Mean   : 0.02057   Mean   :3.588   Mean   :0  
##  3rd Qu.: 0.31354   3rd Qu.: 0.25607   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.03570   Max.   : 0.74172   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# femlaes}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2         
##  Min.   :201.0   M:  0   Min.   :-0.6738   Min.   :-0.4681  
##  1st Qu.:250.8   F:200   1st Qu.: 0.4142   1st Qu.: 0.2204  
##  Median :300.5           Median : 0.7036   Median : 0.5145  
##  Mean   :300.5           Mean   : 0.7201   Mean   : 0.5180  
##  3rd Qu.:350.2           3rd Qu.: 1.0027   3rd Qu.: 0.7993  
##  Max.   :400.0           Max.   : 1.9696   Max.   : 1.7483  
##        S3                  S4                S5                S6         
##  Min.   :-0.831129   Min.   :-0.4189   Min.   :-0.7119   Min.   :-0.7447  
##  1st Qu.:-0.004372   1st Qu.: 0.3553   1st Qu.: 0.2530   1st Qu.: 0.1068  
##  Median : 0.284222   Median : 0.6668   Median : 0.5487   Median : 0.3653  
##  Mean   : 0.297638   Mean   : 0.6501   Mean   : 0.5298   Mean   : 0.3503  
##  3rd Qu.: 0.599074   3rd Qu.: 0.9392   3rd Qu.: 0.7725   3rd Qu.: 0.6109  
##  Max.   : 1.434084   Max.   : 1.7767   Max.   : 1.4150   Max.   : 1.4043  
##        S7                S8                S9              symptoms  
##  Min.   :-0.1164   Min.   :-0.4087   Min.   :-0.65910   Min.   :0.0  
##  1st Qu.: 0.4447   1st Qu.: 0.1846   1st Qu.: 0.05451   1st Qu.:4.0  
##  Median : 0.6933   Median : 0.5135   Median : 0.27709   Median :5.0  
##  Mean   : 0.7266   Mean   : 0.4756   Mean   : 0.30995   Mean   :5.3  
##  3rd Qu.: 1.0179   3rd Qu.: 0.7246   3rd Qu.: 0.55945   3rd Qu.:7.0  
##  Max.   : 1.6591   Max.   : 1.5347   Max.   : 1.60357   Max.   :9.0  
##       ASD      
##  Min.   :0.00  
##  1st Qu.:0.00  
##  Median :0.00  
##  Mean   :0.46  
##  3rd Qu.:1.00  
##  Max.   :1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ASD females}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender       S1               S2                S3         
##  Min.   :201.0   M: 0   Min.   :0.0347   Min.   :-0.4681   Min.   :-0.6183  
##  1st Qu.:240.8   F:92   1st Qu.:0.6562   1st Qu.: 0.4725   1st Qu.: 0.3357  
##  Median :289.5          Median :0.8611   Median : 0.6829   Median : 0.5707  
##  Mean   :295.7          Mean   :0.8931   Mean   : 0.7108   Mean   : 0.5532  
##  3rd Qu.:353.2          3rd Qu.:1.1390   3rd Qu.: 0.9650   3rd Qu.: 0.8140  
##  Max.   :399.0          Max.   :1.9696   Max.   : 1.7483   Max.   : 1.4341  
##        S4                S5                S6                S7          
##  Min.   :-0.4189   Min.   :-0.2432   Min.   :-0.7447   Min.   :-0.09004  
##  1st Qu.: 0.5662   1st Qu.: 0.4985   1st Qu.: 0.3160   1st Qu.: 0.61552  
##  Median : 0.7547   Median : 0.6559   Median : 0.5294   Median : 0.85587  
##  Mean   : 0.7944   Mean   : 0.7011   Mean   : 0.5493   Mean   : 0.85956  
##  3rd Qu.: 1.0124   3rd Qu.: 0.9602   3rd Qu.: 0.7152   3rd Qu.: 1.10252  
##  Max.   : 1.7767   Max.   : 1.4150   Max.   : 1.4043   Max.   : 1.56483  
##        S8                S9             symptoms          ASD   
##  Min.   :-0.1478   Min.   :-0.5090   Min.   :6.000   Min.   :1  
##  1st Qu.: 0.5357   1st Qu.: 0.2723   1st Qu.:6.000   1st Qu.:1  
##  Median : 0.6551   Median : 0.4595   Median :7.000   Median :1  
##  Mean   : 0.6784   Mean   : 0.5020   Mean   :7.196   Mean   :1  
##  3rd Qu.: 0.8769   3rd Qu.: 0.7581   3rd Qu.:8.000   3rd Qu.:1  
##  Max.   : 1.5347   Max.   : 1.6036   Max.   :9.000   Max.   :1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# female controls}
\NormalTok{D_2c }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(gender }\OperatorTok{==}\StringTok{ "F"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(ASD }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     agentID      gender        S1                S2                S3          
##  Min.   :203.0   M:  0   Min.   :-0.6738   Min.   :-0.4430   Min.   :-0.83113  
##  1st Qu.:260.8   F:108   1st Qu.: 0.2458   1st Qu.: 0.1200   1st Qu.:-0.18032  
##  Median :307.5           Median : 0.5737   Median : 0.3512   Median : 0.10341  
##  Mean   :304.6           Mean   : 0.5728   Mean   : 0.3538   Mean   : 0.07996  
##  3rd Qu.:344.0           3rd Qu.: 0.9128   3rd Qu.: 0.5713   3rd Qu.: 0.29617  
##  Max.   :400.0           Max.   : 1.6193   Max.   : 1.2312   Max.   : 1.08256  
##        S4                S5                S6                 S7         
##  Min.   :-0.2993   Min.   :-0.7119   Min.   :-0.65829   Min.   :-0.1164  
##  1st Qu.: 0.2334   1st Qu.: 0.1485   1st Qu.:-0.09751   1st Qu.: 0.3531  
##  Median : 0.5130   Median : 0.3440   Median : 0.17094   Median : 0.6012  
##  Mean   : 0.5273   Mean   : 0.3839   Mean   : 0.18076   Mean   : 0.6133  
##  3rd Qu.: 0.8130   3rd Qu.: 0.6217   3rd Qu.: 0.45037   3rd Qu.: 0.8033  
##  Max.   : 1.5763   Max.   : 1.2144   Max.   : 0.89471   Max.   : 1.6591  
##        S8                  S9              symptoms          ASD   
##  Min.   :-0.408655   Min.   :-0.65910   Min.   :0.000   Min.   :0  
##  1st Qu.: 0.009714   1st Qu.:-0.06296   1st Qu.:3.000   1st Qu.:0  
##  Median : 0.239628   Median : 0.15254   Median :4.000   Median :0  
##  Mean   : 0.302730   Mean   : 0.14635   Mean   :3.685   Mean   :0  
##  3rd Qu.: 0.547007   3rd Qu.: 0.29925   3rd Qu.:5.000   3rd Qu.:0  
##  Max.   : 1.134150   Max.   : 1.00490   Max.   :5.000   Max.   :0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# run simulation with 100 % males in diagnostic updating sample}
\NormalTok{results_2c <-}\StringTok{ }\KeywordTok{run_simulation}\NormalTok{(}\DataTypeTok{full_dataset =}\NormalTok{ D_2c, }\DataTypeTok{iterations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{n_sample =} \DecValTok{20}\NormalTok{, }\DataTypeTok{n_diagnostic_symptoms =} \DecValTok{5}\NormalTok{, }\DataTypeTok{n_symptom_cutoff =} \DecValTok{4}\NormalTok{, }\DataTypeTok{male_percent =} \DecValTok{1}\NormalTok{)}


\CommentTok{# assign outcome dataframes to variables }
\NormalTok{sim_data_2c <-}\StringTok{ }\NormalTok{results_2c[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{vec_data_2c <-}\StringTok{ }\NormalTok{results_2c[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{eval_data_2c <-}\StringTok{ }\NormalTok{results_2c[[}\DecValTok{3}\NormalTok{]]}



\NormalTok{### Restructure outcome of simulation 2.c }\AlertTok{###}

\CommentTok{# run functions to determine FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{eval_long_2c <-}\StringTok{ }\KeywordTok{evaluation_long}\NormalTok{(eval_data_2c)}
\NormalTok{long_2c <-}\StringTok{ }\NormalTok{eval_long_2c[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{eval_wide_2c <-}\StringTok{ }\KeywordTok{evaluation_wide}\NormalTok{(eval_data_2c)}
\NormalTok{wide_2c <-}\StringTok{ }\NormalTok{eval_wide_2c[[}\DecValTok{1}\NormalTok{]]}


\CommentTok{# run function to calculate percentage of FP's, FN's, TP's, and TN's for each iteration}
\NormalTok{perc_all_2c <-}\StringTok{ }\KeywordTok{percentage_converter_all}\NormalTok{(eval_data_2c)}

\CommentTok{# run function to calculate ratio of FN's to TP's}
\NormalTok{perc_ASD_2c <-}\StringTok{ }\KeywordTok{percentage_converter_ASD}\NormalTok{(eval_data_2c)}


\CommentTok{# run function that makes a dataframe containing information of the pervalence of the symptoms}
\CommentTok{# being present in the diagnostic criteria}
\NormalTok{diag_symp_2c <-}\StringTok{ }\KeywordTok{find_diagnostic_symptoms}\NormalTok{(vec_data_2c)}



\NormalTok{### Visualizations via plots and graphs 2.c }\AlertTok{###}

\CommentTok{# create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (total count values)}
\CommentTok{# uses first list element (the wide format data frame) of the output from evaluation_wide())}
\KeywordTok{ggplot}\NormalTok{(wide_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total FP, FN, TP, TN, simulation 2.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-58.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (total count values)}
\KeywordTok{ggplot}\NormalTok{(wide_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives, simulation 2.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-59.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women}
\KeywordTok{ggplot}\NormalTok{(wide_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Females, simulation 2.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-60.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men}
\KeywordTok{ggplot}\NormalTok{(wide_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'n individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total False Negatives in Males, simulation 2.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-61.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#  create line plot of the progression of the amount of FP's, FN's, TP's, and TN's for each gender over time (percentage)}
\KeywordTok{ggplot}\NormalTok{(perc_all_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_f, }\DataTypeTok{color =} \StringTok{"females, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_f, }\DataTypeTok{color =} \StringTok{"females, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_f, }\DataTypeTok{color =} \StringTok{"females, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TP_m, }\DataTypeTok{color =} \StringTok{"males, TP"}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males, FN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FP_m, }\DataTypeTok{color =} \StringTok{"males, FP"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ TN_m, }\DataTypeTok{color =} \StringTok{"males, TN"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of FP, FN, TP, TN, simulation 2.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-62.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# single out the progression of FN's (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c))) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_f, }\DataTypeTok{color =} \StringTok{"females"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ FN_m, }\DataTypeTok{color =} \StringTok{"males"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives, simulation 2.c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-63.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among women (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c), }\DataTypeTok{y =}\NormalTok{ FN_f)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"lightcoral"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Females, simulation 2.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-64.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# what is the trend in FN's among men (percentage, ASD only)}
\KeywordTok{ggplot}\NormalTok{(perc_ASD_2c, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(wide_2c), }\DataTypeTok{y =}\NormalTok{ FN_m)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{color =} \StringTok{"steelblue"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{ (}\StringTok{'% of individuals'}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{'iterations'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Percentage of False Negatives in Males, simulation 2.c"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{, }\DataTypeTok{se =}\NormalTok{ F, }\DataTypeTok{color =} \StringTok{"seagreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-65.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "binary heatmap" depicts the progression of the inclusion of symptoms in the diagnostic criteria over time}
\CommentTok{# uses output from find_diagnostic_symptoms()}
\KeywordTok{heatmap}\NormalTok{(diag_symp_2c, }\DataTypeTok{scale =} \StringTok{"none"}\NormalTok{, }\DataTypeTok{Rowv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{Colv =} \OtherTok{NA}\NormalTok{, }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"orangered3"}\NormalTok{, }\StringTok{"seagreen"}\NormalTok{), }\DataTypeTok{main =} \StringTok{"Symptom inclusion, simulation 2.c"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{ABM---SOCCULT-EXAM---final-edition-2_files/figure-latex/unnamed-chunk-1-66.pdf}

\end{document}
